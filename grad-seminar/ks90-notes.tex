%================================================
%    sheaves on manifolds ノート
%================================================

% -----------------------
% preamble
% -----------------------
% ここから本文 (\begin{document}) までの
% ソースコードに変更を加えた場合は
% 編集者まで連絡してください. 
% Don't change preamble code yourself. 
% If you add something
% (usepackage, newtheorem, newcommand, renewcommand),
% please tell it 
% to the editor of institutional paper of RUMS.

% ------------------------
% documentclass
% ------------------------
\documentclass[9pt, b5paper, dvipdfmx, leqno]{jsreport}

% ------------------------
% usepackage
% ------------------------
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{amscd}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage[psamsfonts]{amssymb}
\usepackage{amsthm}
\usepackage{ascmac}
\usepackage{bm}
\usepackage{color}
\usepackage{enumerate}
\usepackage{fancybox}
\usepackage[stable]{footmisc}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{mathrsfs}
\usepackage{mathtools}
\usepackage{otf}
\usepackage{pifont}
\usepackage{proof}
\usepackage{subfigure}
\usepackage{tikz}
\usepackage{verbatim}
\usepackage[all]{xy}
\usepackage{url}
\usetikzlibrary{cd}



% ================================
% パッケージを追加する場合のスペース 
%\usepackage{calligra}
\usepackage[dvipdfmx]{hyperref}
\usepackage{xcolor}
\definecolor{darkgreen}{rgb}{0,0.45,0} 
\definecolor{darkred}{rgb}{0.75,0,0}
\definecolor{darkblue}{rgb}{0,0,0.6} 
\hypersetup{
    colorlinks=true,
    citecolor=darkgreen,
    linkcolor=darkred,
    urlcolor=darkblue,
}
\usepackage{pxjahyper}
\usepackage[mathcal]{euscript}
\usepackage{layout}
\usepackage{framed}
\definecolor{lightgray}{rgb}{0.75,0.75,0.75}
\renewenvironment{leftbar}{%
  \def\FrameCommand{\textcolor{lightgray}{\vrule width 0.7zw} \hspace{10pt}}% 
  \MakeFramed {\advance\hsize-\width \FrameRestore}}%
{\endMakeFramed}
\newenvironment{redleftbar}{%
  \def\FrameCommand{\textcolor{red}{\vrule width 1pt} \hspace{10pt}}% 
  \MakeFramed {\advance\hsize-\width \FrameRestore}}%
 {\endMakeFramed}

%=================================

%============================================================
% layout for a4 9pt
%\setlength{\textwidth}{459pt}
%\setlength{\marginparwidth}{105pt}
%\setlength{\evensidemargin}{69pt}
%============================================================

% --------------------------
% theoremstyle
% --------------------------
\theoremstyle{definition}

% --------------------------
% newtheoem
% --------------------------

% 日本語で定理, 命題, 証明などを番号付きで用いるためのコマンドです. 
% If you want to use theorem environment in Japanece, 
% you can use these code. 
% Attention!
% All theorem enivironment numbers depend on 
% only section numbers.
\newtheorem{Axiom}{公理}[section]
\newtheorem{Definition}[Axiom]{定義}
\newtheorem{Theorem}[Axiom]{定理}
\newtheorem{Proposition}[Axiom]{命題}
\newtheorem{Lemma}[Axiom]{補題}
\newtheorem{Corollary}[Axiom]{系}
\newtheorem{Example}[Axiom]{例}
\newtheorem{Claim}[Axiom]{主張}
\newtheorem{Property}[Axiom]{性質}
\newtheorem{Attention}[Axiom]{注意}
\newtheorem{Question}[Axiom]{問}
\newtheorem{Problem}[Axiom]{問題}
\newtheorem{Consideration}[Axiom]{考察}
\newtheorem{Alert}[Axiom]{警告}
\newtheorem{Fact}[Axiom]{事実}
\newtheorem{com}[Axiom]{コメント}


% 日本語で定理, 命題, 証明などを番号なしで用いるためのコマンドです. 
% If you want to use theorem environment with no number in Japanese, You can use these code.
\newtheorem*{Axiom*}{公理}
\newtheorem*{Definition*}{定義}
\newtheorem*{Theorem*}{定理}
\newtheorem*{Proposition*}{命題}
\newtheorem*{Lemma*}{補題}
\newtheorem*{Example*}{例}
\newtheorem*{Corollary*}{系}
\newtheorem*{Claim*}{主張}
\newtheorem*{Property*}{性質}
\newtheorem*{Attention*}{注意}
\newtheorem*{Question*}{問}
\newtheorem*{Problem*}{問題}
\newtheorem*{Consideration*}{考察}
\newtheorem*{Alert*}{警告}
\newtheorem*{Fact*}{事実}
\newtheorem*{com*}{コメント}



% 英語で定理, 命題, 証明などを番号付きで用いるためのコマンドです. 
%　If you want to use theorem environment in English, You can use these code.
%all theorem enivironment number depend on only section number.
\newtheorem{Axiom+}{Axiom}[section]
\newtheorem{Definition+}[Axiom+]{Definition}
\newtheorem{Theorem+}[Axiom+]{Theorem}
\newtheorem{Proposition+}[Axiom+]{Proposition}
\newtheorem{Lemma+}[Axiom+]{Lemma}
\newtheorem{Example+}[Axiom+]{Example}
\newtheorem{Corollary+}[Axiom+]{Corollary}
\newtheorem{Claim+}[Axiom+]{Claim}
\newtheorem{Property+}[Axiom+]{Property}
\newtheorem{Attention+}[Axiom+]{Attention}
\newtheorem{Question+}[Axiom+]{Question}
\newtheorem{Problem+}[Axiom+]{Problem}
\newtheorem{Consideration+}[Axiom+]{Consideration}
\newtheorem{Alert+}{Alert}
\newtheorem{Fact+}[Axiom+]{Fact}
\newtheorem{Remark+}[Axiom+]{Remark}

% ----------------------------
% commmand
% ----------------------------
% 執筆に便利なコマンド集です. 
% コマンドを追加する場合は下のスペースへ. 

% 集合の記号 (黒板文字)
\newcommand{\NN}{\mathbb{N}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\QQ}{\mathbb{Q}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\CC}{\mathbb{C}}
\newcommand{\PP}{\mathbb{P}}
\newcommand{\KK}{\mathbb{K}}


% 集合の記号 (太文字)
\newcommand{\nn}{\mathbf{N}}
\newcommand{\zz}{\mathbf{Z}}
\newcommand{\qq}{\mathbf{Q}}
\newcommand{\rr}{\mathbf{R}}
\newcommand{\cc}{\mathbf{C}}
\newcommand{\pp}{\mathbf{P}}
\newcommand{\kk}{\mathbf{K}}

% 特殊な写像の記号
\newcommand{\ev}{\mathop{\mathrm{ev}}\nolimits} % 値写像
\newcommand{\pr}{\mathop{\mathrm{pr}}\nolimits} % 射影

% スクリプト体にするコマンド
%   例えば　{\mcal C} のように用いる
\newcommand{\mcal}{\mathcal}

% 花文字にするコマンド 
%   例えば　{\h C} のように用いる
\newcommand{\h}{\mathscr}

% ヒルベルト空間などの記号
\newcommand{\F}{\mcal{F}}
\newcommand{\X}{\mcal{X}}
\newcommand{\Y}{\mcal{Y}}
\newcommand{\Hil}{\mcal{H}}
\newcommand{\RKHS}{\Hil_{k}}
\newcommand{\Loss}{\mcal{L}_{D}}
\newcommand{\MLsp}{(\X, \Y, D, \Hil, \Loss)}

% 偏微分作用素の記号
\newcommand{\p}{\partial}

% 角カッコの記号 (内積は下にマクロがあります)
\newcommand{\lan}{\langle}
\newcommand{\ran}{\rangle}



% 圏の記号など
\newcommand{\Set}{{\bf Set}}
\newcommand{\Vect}{{\bf Vect}}
\newcommand{\FDVect}{{\bf FDVect}}
\newcommand{\Mod}{\mathop{\mathrm{Mod}}\nolimits}
\newcommand{\CGA}{{\bf CGA}}
\newcommand{\GVect}{{\bf GVect}}
\newcommand{\Lie}{{\bf Lie}}
\newcommand{\dLie}{{\bf Liec}}



% 射の集合など
\newcommand{\Map}{\mathop{\mathrm{Map}}\nolimits}
\newcommand{\Hom}{\mathop{\mathrm{Hom}}\nolimits}
\newcommand{\End}{\mathop{\mathrm{End}}\nolimits}
\newcommand{\Aut}{\mathop{\mathrm{Aut}}\nolimits}
\newcommand{\Mor}{\mathop{\mathrm{Mor}}\nolimits}

% その他便利なコマンド
\newcommand{\dip}{\displaystyle} % 本文中で数式モード
\newcommand{\e}{\varepsilon} % イプシロン
\newcommand{\dl}{\delta} % デルタ
\newcommand{\pphi}{\varphi} % ファイ
\newcommand{\ti}{\tilde} % チルダ
\newcommand{\pal}{\parallel} % 平行
\newcommand{\op}{{\rm op}} % 双対を取る記号
\newcommand{\lcm}{\mathop{\mathrm{lcm}}\nolimits} % 最小公倍数の記号
\newcommand{\Probsp}{(\Omega, \F, \P)} 
\newcommand{\argmax}{\mathop{\rm arg~max}\limits}
\newcommand{\argmin}{\mathop{\rm arg~min}\limits}





% ================================
% コマンドを追加する場合のスペース 
\renewcommand\proofname{\bf 証明} % 証明
\numberwithin{equation}{section}
\newcommand{\cTop}{\textsf{Top}}
%\newcommand{\cOpen}{\textsf{Open}}
\newcommand{\Op}{\mathop{\textsf{Op}}\nolimits}
\newcommand{\Ob}{\mathop{\textrm{Ob}}\nolimits}
\newcommand{\id}{\mathop{\mathrm{id}}\nolimits}
\newcommand{\pt}{\mathop{\mathrm{pt}}\nolimits}
\newcommand{\Int}{\mathop{\mathrm{Int}}\nolimits}
\newcommand{\res}{\mathop{\rho}\nolimits}
\newcommand{\A}{\mcal{A}}
\newcommand{\B}{\mcal{B}}
\newcommand{\C}{\mcal{C}}
\newcommand{\D}{\mcal{D}}
\newcommand{\E}{\mcal{E}}
\newcommand{\G}{\mcal{G}}
%\newcommand{\H}{\mcal{H}}
\newcommand{\I}{\mcal{I}}
\newcommand{\J}{\mcal{J}}
\newcommand{\OO}{\mcal{O}}
\newcommand{\Ring}{\mathop{\textsf{Ring}}\nolimits}
\newcommand{\cAb}{\mathop{\textsf{Ab}}\nolimits}
\newcommand{\Ker}{\mathop{\mathrm{Ker}}\nolimits}
\newcommand{\im}{\mathop{\mathrm{Im}}\nolimits}
\newcommand{\rk}{\mathop{\mathrm{rank}}\nolimits}
\newcommand{\Coker}{\mathop{\mathrm{Coker}}\nolimits}
\newcommand{\Coim}{\mathop{\mathrm{Coim}}\nolimits}
\newcommand{\Ht}{\mathop{\mathrm{Ht}}\nolimits}
\newcommand{\supp}{\mathop{\mathrm{supp}}\nolimits}
\newcommand{\colim}{\mathop{\mathrm{colim}}}
\newcommand{\Tor}{\mathop{\mathrm{Tor}}\nolimits}

\newcommand{\cat}{\mathscr{C}}

%筆記体
\newcommand{\cA}{\mcal{A}}
\newcommand{\cB}{\mcal{B}}
\newcommand{\cC}{\mcal{C}}
\newcommand{\cD}{\mcal{D}}
\newcommand{\cE}{\mcal{E}}
\newcommand{\cF}{\mcal{F}}
\newcommand{\cG}{\mcal{G}}
\newcommand{\cH}{\mcal{H}}
\newcommand{\cI}{\mcal{I}}
\newcommand{\cJ}{\mcal{J}}
\newcommand{\cK}{\mcal{K}}
\newcommand{\cL}{\mcal{L}}
\newcommand{\cM}{\mcal{M}}
\newcommand{\cN}{\mcal{N}}
\newcommand{\cO}{\mcal{O}}
\newcommand{\cP}{\mcal{P}}
\newcommand{\cQ}{\mcal{Q}}
\newcommand{\cR}{\mcal{R}}
\newcommand{\cS}{\mcal{S}}
\newcommand{\cT}{\mcal{T}}
\newcommand{\cU}{\mcal{U}}
\newcommand{\cV}{\mcal{V}}
\newcommand{\cW}{\mcal{W}}
\newcommand{\cX}{\mcal{X}}
\newcommand{\cY}{\mcal{Y}}
\newcommand{\cZ}{\mcal{Z}}

\newcommand{\rmD}{\mathrm{D}}


\newcommand{\scA}{\mathscr{A}}
\newcommand{\scB}{\mathscr{B}}
\newcommand{\scC}{\mathscr{C}}
\newcommand{\scD}{\mathscr{D}}
\newcommand{\scE}{\mathscr{E}}
\newcommand{\scF}{\mathscr{F}}
\newcommand{\scN}{\mathscr{N}}
\newcommand{\scO}{\mathscr{O}}
\newcommand{\scR}{\mathscr{R}}
\newcommand{\scS}{\mathscr{S}}
\newcommand{\scV}{\mathscr{V}}

\newcommand{\ibA}{\mathop{\text{\textit{\textbf{A}}}}}
\newcommand{\ibB}{\mathop{\text{\textit{\textbf{B}}}}}
\newcommand{\ibC}{\mathop{\text{\textit{\textbf{C}}}}}
\newcommand{\ibD}{\mathop{\text{\textit{\textbf{D}}}}}
\newcommand{\ibE}{\mathop{\text{\textit{\textbf{E}}}}}
\newcommand{\ibF}{\mathop{\text{\textit{\textbf{F}}}}}
\newcommand{\ibG}{\mathop{\text{\textit{\textbf{G}}}}}
\newcommand{\ibH}{\mathop{\text{\textit{\textbf{H}}}}}
\newcommand{\ibI}{\mathop{\text{\textit{\textbf{I}}}}}
\newcommand{\ibJ}{\mathop{\text{\textit{\textbf{J}}}}}
\newcommand{\ibK}{\mathop{\text{\textit{\textbf{K}}}}}
\newcommand{\ibL}{\mathop{\text{\textit{\textbf{L}}}}}
\newcommand{\ibM}{\mathop{\text{\textit{\textbf{M}}}}}
\newcommand{\ibN}{\mathop{\text{\textit{\textbf{N}}}}}
\newcommand{\ibO}{\mathop{\text{\textit{\textbf{O}}}}}
\newcommand{\ibP}{\mathop{\text{\textit{\textbf{P}}}}}
\newcommand{\ibQ}{\mathop{\text{\textit{\textbf{Q}}}}}
\newcommand{\ibR}{\mathop{\text{\textit{\textbf{R}}}}}
\newcommand{\ibS}{\mathop{\text{\textit{\textbf{S}}}}}
\newcommand{\ibT}{\mathop{\text{\textit{\textbf{T}}}}}
\newcommand{\ibU}{\mathop{\text{\textit{\textbf{U}}}}}
\newcommand{\ibV}{\mathop{\text{\textit{\textbf{V}}}}}
\newcommand{\ibW}{\mathop{\text{\textit{\textbf{W}}}}}
\newcommand{\ibX}{\mathop{\text{\textit{\textbf{X}}}}}
\newcommand{\ibY}{\mathop{\text{\textit{\textbf{Y}}}}}
\newcommand{\ibZ}{\mathop{\text{\textit{\textbf{Z}}}}}

\newcommand{\ibx}{\mathop{\text{\textit{\textbf{x}}}}}

\newcommand{\Comp}{\mathop{\mathrm{C}}\nolimits}
\newcommand{\Komp}{\mathop{\mathsf{K}}\nolimits}
\newcommand{\Domp}{\mathop{\mathsf{D}}\nolimits}
\newcommand{\Kompl}{\mathop{\mathsf{K}^\mathrm{+}}\nolimits}
\newcommand{\Kompu}{\mathop{\mathsf{K}^\mathrm{-}}\nolimits}
\newcommand{\Kompb}{\mathop{\mathsf{K}^\mathrm{b}}\nolimits}
\newcommand{\Dompl}{\mathop{\mathsf{D}^\mathrm{+}}\nolimits}
\newcommand{\Dompu}{\mathop{\mathsf{D}^\mathrm{-}}\nolimits}
\newcommand{\Dompb}{\mathop{\mathsf{D}^\mathrm{b}}\nolimits}

\newcommand{\CCat}{\Comp(\cat)}
\newcommand{\KCat}{\Komp(\cat)}
\newcommand{\DCat}{\Domp(\cat)}%圏Cの複体のホモトピー圏
\newcommand{\HOM}{\mathop{\mathscr{H}\hspace{-2pt}om}\nolimits}%内部Hom
\newcommand{\RHOM}{\mathop{\mathrm{R}\hspace{-1.5pt}\HOM}\nolimits}

\newcommand{\muS}{\mathop{\mathrm{SS}}\nolimits}
\newcommand{\RG}{\mathop{\mathrm{R}\hspace{-0pt}\Gamma}\nolimits}
\newcommand{\RHom}{\mathop{\mathrm{R}\hspace{-1.5pt}\Hom}\nolimits}
\newcommand{\Rder}{\mathrm{R}}

\newcommand{\simar}{\mathrel{\overset{\sim}{\longrightarrow}}}%内部Hom
\newcommand{\simra}{\mathrel{\overset{\sim}{\longleftarrow}}}%内部Hom

\newcommand{\hocolim}{{\mathrm{hocolim}}}
\newcommand{\indlim}[1][]{\mathop{\varinjlim}\limits_{#1}}
\newcommand{\sindlim}[1][]{\smash{\mathop{\varinjlim}\limits_{#1}}\,}
\newcommand{\Pro}{\mathrm{Pro}}
\newcommand{\Ind}{\mathrm{Ind}}
\newcommand{\prolim}[1][]{\mathop{\varprojlim}\limits_{#1}}
\newcommand{\sprolim}[1][]{\smash{\mathop{\varprojlim}\limits_{#1}}\,}

\newcommand{\Sh}{\mathrm{Sh}}
\newcommand{\PSh}{\mathrm{PSh}}

\newcommand{\Lloc}[1][]{\mathord{\mathcal{L}^1_{\mathrm{loc},{#1}}}}
\newcommand{\ori}{\mathord{\mathrm{or}}}
\newcommand{\Db}{\mathord{\mathscr{D}b}}
\newcommand{\Conti}{\mathord{\mathscr{C}}}

\newcommand{\mres}[2][]{{\left.{#1}\right\rvert}_{#2}}
\newcommand{\blk}{\mathord{\ \cdot\ }}

\newcommand{\tens}[1][]{\mathbin{\otimes_{\raise1.5ex\hbox to-.1em{}{#1}}}}
\newcommand{\ttens}[1][]{\mathbin{\mathop{\overset{\mathrm{}}{\tens}}_{#1}}}

\newcommand{\etens}{\mathbin{\boxtimes}}
\newcommand{\ltens}[1][]{\mathbin{\overset{\mathrm{L}}\tens}_{#1}}
\newcommand{\mtens}[1][]{\mathbin{\overset{\mathrm{\mu}}\tens}_{#1}}
\newcommand{\lltens}[1][]{{\mathop{\tens}\limits^{\mathrm{L}}_{#1}}}
%\newcommand{\letens}{\overset{\mathrm{L}}{\etens}}
\newcommand{\detens}{\underline{\etens}}
\newcommand{\ldetens}{\overset{\mathrm{L}}{\underline{\etens}}}
\newcommand{\dtens}[1][]{{\overset{\mathrm{L}}{\underline{\otimes}}}_{#1}}

\newcommand{\letens}[1][]{\mathbin{\mathop{\overset{\mathrm{L}}{\etens}}_{#1}}}

% =================================



%================================================
% 自前の定理環境
%   https://mathlandscape.com/latex-amsthm/
% を参考にした
\newtheoremstyle{mystyle}%   % スタイル名
    {5pt}%                   % 上部スペース
    {5pt}%                   % 下部スペース
    {}%              % 本文フォント
    {}%                  % 1行目のインデント量
    {\bfseries}%                      % 見出しフォント
    {.}%                     % 見出し後の句読点
    {12pt}%                     % 見出し後のスペース
    {\thmname{#1}\thmnumber{ #2}\thmnote{{\hspace{2pt}\normalfont (#3)}}}% % 見出しの書式

\theoremstyle{mystyle}
\newtheorem{AXM}{公理}[section]
\newtheorem{DFN}[Axiom]{定義}
\newtheorem{THM}[Axiom]{定理}
\newtheorem*{THM*}{定理}
\newtheorem{STT}{主張}[chapter]
\newtheorem*{STT*}{主張}
\newtheorem{PRP}[Axiom]{命題}
\newtheorem{LMM}[Axiom]{補題}
\newtheorem{CRL}[Axiom]{系}
\newtheorem{EG}[Axiom]{例}
\newtheorem{CNV}[Axiom]{規約}
\newtheorem{RMK}[Axiom]{注意}
\newtheorem{CMT}{コメント}[chapter]
\newtheorem*{CMT*}{コメント}


% 定理環境ここまで
%====================================================

% ---------------------------
% new definition macro
% ---------------------------
% 便利なマクロ集です

% 内積のマクロ
%   例えば \inner<\pphi | \psi> のように用いる
\def\inner<#1>{\langle #1 \rangle}

% ================================
% マクロを追加する場合のスペース 

%=================================





% ----------------------------
% documenet 
% ----------------------------
% 以下, 本文の執筆スペースです. 
% Your main code must be written between 
% begin document and end document.
% ---------------------------

\title{Notes on Sheaves on Manifolds}
\author{大柴寿浩}
\date{\today 更新}
\begin{document}
\maketitle
%\frontmatter
\layout
\chapter*{はじめに}
2023年度から始めた\cite{KS90}のセミナーのノート．

\section*{記号}
次の記号は断りなく使う．
\begin{itemize}
    \item 添字：
    なんらかの族$(a_i)_{i\in I}$を$(a_i)_i$とか$(a_i)$と
    略記することがある．
    \item 近傍：位相空間\(X\)の点\(x\)や部分集合\(Z\)に対し，
    その開近傍系をそれぞれ\(I_x\)や\(I_Z\)で表す．
    これらは，包含関係の逆で有向順序集合をなす．
\end{itemize}
\tableofcontents
%\mainmatter
\chapter{ホモロジー代数}
\setcounter{section}{2}

\section{複体の圏}

$\cat$を加法圏とする．
\begin{Attention*}
    加法圏とは次の3つの条件(\ref{additive:bilin})--(\ref{additive:biproduct})をみたす圏のことである．
    \begin{enumerate}
        \renewcommand{\labelenumi}{({\arabic{enumi}})}
        \item どの対象$X, Y\in\cat$に対しても$\Hom_{\cat}(X,Y)$が
        加法群になり，どの対象$X, Y, Z\in\cat$に対しても
        合成$\circ\colon\Hom_{\cat}(Y,Z)\times\Hom_{\cat}(X,Y)
        \to\Hom_{\cat}(X,Z)$が双線型である．\label{additive:bilin}
        \item 零対象$0\in\cat$が存在する．
        さらに$\Hom_{\cat}(0,0)=0$が成り立つ．\label{additive:zero}
        \item 任意の対象$X, Y\in\cat$に対して積と余積が存在し，
        さらにそれらは同型になる．（それらを複積といい$X\oplus Y$とかく．）\label{additive:biproduct}
    \end{enumerate}
\end{Attention*}
圏$\cat$から，
$\cat$の対象の複体の圏$\Comp(\cat)$を作ることができる．
まず複体の定義をする．
圏$\cat$の対象のと射の列
\begin{equation}\label{eq:complex}
    \begin{tikzcd}[column sep=0.6cm]
        \cdots
        \arrow[r]
        &
        X^{n-1}
        \arrow[r,"d_X^{n-1}"] 
        &[+0.3cm]%[-0.03\linewidth]
        X^n
        \arrow[r,"d_X^{n}"]
        &%[0.12\linewidth]
        X^{n+1}
        \arrow[r, ""] 
        &%[0.12\linewidth]
        \cdots
    \end{tikzcd}
\end{equation}
を考える．
この列$X=\left((X^n)_{n\in\zz},(d_X^{n})_{n\in\zz}\right)$が
\textbf{複体} (complex) であるとは，任意の$n\in\zz$に対し
\begin{equation}
    d_X^{n+1}\circ d_X^{n}=0
\end{equation}
が成り立つことをいう．

圏$\cat$の
対象の複体$X=((X^n),(d_X^{n}))$, $Y=((Y^n),(d_Y^{n}))$の間の射を，
$\cat$の射の族$(f^n\colon X^n\to Y^n)_{n\in\zz}$で，
図式
\begin{equation*}
    \vcenter{\xymatrix@C=26pt@R=26pt{
    \cdots \ar[r]
    & 
    X^{n}
    \ar[r]^-{d_X^n}
    \ar[d]^-{f^n}
    &
    X^{n+1}
    \ar[r]
    \ar[d]^-{f^{n+1}} 
    &\cdots
    \\
    \cdots \ar[r]
    & 
    Y^{n}
    \ar[r]^-{d_Y^n}
    &
    Y^{n+1}
    \ar[r]
    &\cdots
    }}
\end{equation*}
を可換にする，すなわちどの番号$n\in\zz$に対しても
\begin{equation}
    d_Y^n\circ f^n=f^{n+1}\circ d_X^n 
\end{equation}
が成り立つものとして定める．

以上の準備のもとで，$\cat$の複体の圏$\Comp(\cat)$を次のように定める．
\begin{itemize}
    \item 対象：$\Ob(\Comp(\cat))=\{\text{$\cat$の複体}\}$
    \item 射：$\Hom_{\Comp(\cat)}(X,Y)=\{\text{$\cat$の複体の射}\}$
\end{itemize}
このとき，$\CCat$は加法圏になる．
\begin{proof}[\textbf{圏になることの証明}]
    $f\colon X\to Y$と$g\colon Y\to Z$を$\CCat$の射とする．
    $f$と$g$の合成$g\circ f$は$(g^n\circ f^n)_n$で与えられる．
    これがうまくいくことは
    \begin{equation*}
        \vcenter{\xymatrix@C=26pt@R=26pt{
        \cdots \ar[r]
        & 
        X^{n}
        \ar[r]^-{d_X^n}
        \ar[d]^-{f^n}
        &
        X^{n+1}
        \ar[r]
        \ar[d]^-{f^{n+1}} 
        &\cdots
        \\
        \cdots \ar[r]
        & 
        Y^{n}
        \ar[r]^-{d_Y^n}
        \ar[d]^-{g^n}
        &
        Y^{n+1}
        \ar[r]
        \ar[d]^-{g^{n+1}} 
        &\cdots
        \\
        \cdots \ar[r]
        & 
        Z^{n}
        \ar[r]^-{d_Z^n}
        &
        Z^{n+1}
        \ar[r]
        &\cdots
        }}
    \end{equation*}
    が可換になることからわかる．

    $X$の恒等射は$(\id_{X^n})_n$で与えられる．
\end{proof}
\begin{proof}[\textbf{加法圏になることの証明}]
    $X$と$Y$を$\cat$の複体とする．
    \subparagraph*{(\ref{additive:bilin})射の集合のアーベル群構造}
    $f,g\in\Hom_{\CCat}(X,Y)$に対し，$f+g$が$(f^n+g^n)_n$で定まる．
    \subparagraph*{(\ref{additive:zero})零対象の存在}
    $\CCat$の零対象0は
    \begin{equation*}%\label{eq:complex}
        \begin{tikzcd}[column sep=0.4cm]
            \cdots
            \arrow[r]
            &
            0
            \arrow[r,"0"] 
            &%[+0.3cm]
            0
            \arrow[r,"0"]
            &%[0.12\linewidth]
            0
            \arrow[r, ""] 
            &%[0.12\linewidth]
            \cdots
        \end{tikzcd}
    \end{equation*}
    で与えられる．
    \subparagraph*{(\ref{additive:biproduct})複積の存在}    
    $X$と$Y$の複積$X\oplus Y$は
    \begin{equation*}%\label{eq:complex}
        \begin{tikzcd}[column sep=1.2cm]
            \cdots
            \arrow[r]
            &[-0.6cm]
            X^{n-1}\oplus Y^{n-1}
            \arrow[r,"d_X^{n-1}\oplus d_Y^{n-1}"] 
            &[+0.3cm]%[-0.03\linewidth]
            X^n\oplus Y^{n}
            \arrow[r,"d_X^{n}\oplus d_Y^{n}"]
            &%[0.12\linewidth]
            X^{n+1}\oplus Y^{n+1}
            \arrow[r, ""] 
            &[-0.6cm]%[0.12\linewidth]
            \cdots
        \end{tikzcd}
    \end{equation*}
    で与えられる．
\end{proof}

さらに$\cat$がアーベル圏ならば，$\CCat$もアーベル圏になる．
\begin{Attention*}
    加法圏$\cat$がアーベル圏であるとは
    次の条件(\ref{abel:ker}), (\ref{abel:homTh})をみたすことをいう．
    \begin{enumerate}
        \renewcommand{\labelenumi}{({\arabic{enumi}})}
        \setcounter{enumi}{3}
        \item 任意の$\cat$の射$f\colon X\to Y$に対し，
        $f$の核$\Ker{f}$と余核$\Coker f$が存在する．\label{abel:ker}
        \item 任意の$\cat$の射$f\colon X\to Y$に対し，
        自然に定まる射$\Coim f\to\im f$は同型である．\label{abel:homTh}
    \end{enumerate}
\end{Attention*}

\begin{proof}$X$と$Y$を$\cat$の複体とする．
    \subparagraph*{(\ref{abel:ker})核と余核の存在}
    複体の射$f\colon X\to Y$に対し，
    核$\Ker{f}$は$(\Ker{f^n})_n$で，
    余核$\Coker{f}$は$(\Coker{f^n})_n$で与えられる．
    \begin{com*}[4/24]
        「$\Ker{f}$のdifferentialの構成はどうなっていますか？」

        次の図式を考える．
        \begin{equation*}
            \vcenter{\xymatrix@C=26pt@R=18pt{
            \cdots \ar[r]
            & 
            \Ker{f^{n}}
            \ar[r]^-{\overline{d}_X^n}
            \ar[d]^-{\iota^n}
            &
            \Ker{f^{n+1}}
            \ar[r]
            \ar[d]^-{\iota^{n+1}} 
            &\cdots
            \\    
            \cdots \ar[r]
            & 
            X^{n}
            \ar[r]^-{d_X^n}
            \ar[d]^-{f^n}
            &
            X^{n+1}
            \ar[r]
            \ar[d]^-{f^{n+1}} 
            &\cdots
            \\
            \cdots \ar[r]
            & 
            Y^{n}
            \ar[r]^-{d_Y^n}
            &
            Y^{n+1}
            \ar[r]
            &\cdots
            }}
        \end{equation*}
        ここで，$\iota^n$は$\Ker{f^n}$の普遍性から自然に定まる射である．
        $\overline{d}_X^n\colon\Ker{f^n}\to\Ker{f^{n+1}}$が
        $d_X^n\circ\iota^n$によって定められることを示せば良い．
        \begin{align*}
            f^{n+1}\circ d_X^n\circ\iota^n
            =d_Y^n\circ f^{n+1}\circ\iota^n
            =d_Y^n\circ0=0
        \end{align*}
        より，$d_X^n\circ\iota^n$は$\Ker{f^{n+1}}$に
        値を取る．したがって，
        $\overline{d}_X^n\colon\Ker{f^n}\to\Ker{f^{n+1}}$が定まる．
    \end{com*}

    \subparagraph*{(\ref{abel:homTh})余像と像が同型になること}
    各次数$n$ごとに$\Coim f^n\cong \im f^n$が成り立つことから従う．
\end{proof}
圏$\CCat$の充満部分圏$\Comp^+(\cat)$, 
$\Comp^-(\cat)$, $\Comp^\mathrm{b}(\cat)$を
\begin{align*}
    \Ob(\Comp^+(\cat))
    &=\left\{
        0\rightarrow
        X^{n}\overset{d_X^{n}}{\longrightarrow}
        X^{n+1}\rightarrow\cdots
        \quad (n\ll 0)
    \right\}, \\
    \Ob(\Comp^-(\cat))
    &=\left\{
        \cdots\rightarrow 
        X^{n-1}\overset{d_X^{n-1}}{\longrightarrow}
        X^{n}\rightarrow
        0
        \quad (n\gg 0)
    \right\}, \\
    \Ob(\Comp^\mathrm{b}(\cat))
    &=\left\{ 
        0\rightarrow
        X^{n}\rightarrow
        \cdots\rightarrow 
        X^{m}\rightarrow
        0
        \quad (n\ll 0, m\gg0)
    \right\}
\end{align*}
で定める．

$\cat$の対象$X$に対し$\CCat$の対象
\begin{equation*}
    \cdots\to
    0\rightarrow
    X\rightarrow
    0\to\cdots
\end{equation*}
を対応させることによって，
忠実充満な関手$\cat\hookrightarrow\CCat$が定まる．

$k$を整数とする．$\cat$の複体
\begin{equation*}
    \begin{tikzcd}[column sep=0.6cm]
        X\colon\cdots
        \arrow[r]
        &
        X^{n-1}
        \arrow[r,"d_X^{n-1}"] 
        &[+0.3cm]%[-0.03\linewidth]
        X^n
        \arrow[r,"d_X^{n}"]
        &%[0.12\linewidth]
        X^{n+1}
        \arrow[r, ""] 
        &%[0.12\linewidth]
        \cdots
    \end{tikzcd}
\end{equation*}
に対し，$X[k]$を
$X[k]^n=X^{n+k}$, $d_{X[k]}^n=(-1)^{k}d_X^{n+k}$
で定める．図式でかくと
\begin{equation*}
    \begin{tikzcd}[column sep=1.4cm]
        X[k]\colon\cdots
        \arrow[r]
        &[-1cm]
        X^{n+k-1}
        \arrow[r,"(-1)^kd_X^{n+k-1}"] 
        &[+0.5cm]%[-0.03\linewidth]
        X^{n+k}
        \arrow[r,"(-1)^kd_X^{n+k}"]
        &%[0.12\linewidth]
        X^{n+k+1}
        \arrow[r, ""] 
        &[-1cm]%[0.12\linewidth]
        \cdots
    \end{tikzcd}
\end{equation*}
のようになる．
$X$から$Y$への射$f\colon X\to Y$に対し，
$f[k]\colon X[k]\to Y[k]$を$f[k]^n=f^{n+k}$で定める．
$X$を$X[k]$に対応させることで
関手$[k]\colon\CCat\to\CCat$が定まる．
この関手を次数$k$のシフト関手と呼ぶ．

\begin{proof}[\textbf{$[k]$が関手になることの証明}]
    $X[k]$が複体になること：
    \begin{align*}
        (-1)^kd_X^{n+k}\circ (-1)^kd_X^{n+k-1}
        =(-1)^{2k}d_X^{n+k}\circ d_X^{n+k-1}=0.
    \end{align*} 

    $f[k]$が複体の射になること：
    \begin{equation*}
        \vcenter{\xymatrix
        @C=20pt@R=26pt
        {
        \cdots \ar[r]
        & 
        X^{n+k}
        \ar[rr]^-{(-1)^kd_X^{n+k}}
        \ar[d]^-{f^{n+k}}
        &&
        X^{n+k+1}
        \ar[r]
        \ar[d]^-{f^{n+k+1}} 
        &\cdots
        \\
        \cdots \ar[r]
        & 
        Y^{n+k}
        \ar[rr]^-{(-1)^kd_Y^{n+k}}
        &&
        Y^{n+k+1}
        \ar[r]
        &\cdots
        }}
    \end{equation*}
    が可換になることを示せばよい．
    \begin{align*}
        f^{n+k+1}\circ (-1)^{k}d_X^{n+k+1}
        =(-1)^{k}f^{n+k+1}\circ d_X^{n+k+1}
        =(-1)^{k}d_Y^{n+k+1}\circ f^{n+k}. 
    \end{align*}

    $[k]$が合成を保つこと：
    $f\colon X\to Y$, $g\colon Y\to Z$を複体の射とする．
    このとき
    \begin{align*}
        (g[k]\circ f[k])^n
        =g[k]^n\circ f[k]^n
        =g^{n+k}\circ f^{n+k}
        =(g\circ f)^{n+k}
        =(g\circ f)[k]^n        
    \end{align*}
    が成り立つ．

    $[k]$が恒等射を保つこと：
    $\id_X[k]^n=\id_X^{n+k}=\id_{X[k]}^{n}$.
\end{proof}

\paragraph{ホモトピー}
$\cat$の複体の圏$\CCat$から，ホモトピックな射を同一視することによって，
新たな圏$\KCat$が得られる．まず準備．

$\CCat$を圏$\cat$の複体の圏とする．
$X,Y\in\CCat$とする．
$f\colon X\to Y$が0にホモトピックであるとは，
$\cat$の射の族$(s^n\colon X^n\to Y^{n-1})$で，
\begin{equation}
    f^n=d_Y^{n-1}\circ s^n+s^{n+1}\circ d_X^{n}\quad(n\in\zz)
\end{equation}
となるものが存在することをいう．

$f,g\colon X\to Y$に対し，
$f-g$が0にホモトピックであるとき，
$f$と$g$はホモトピックであるといい，$f\simeq g$とかく．
$f$が0とホモトピックであることを$f\simeq0$で表す．
このとき$s=(s^n)$を$f$と$g$の間のホモトピーという．
$\simeq$は同値関係である．
\begin{proof}$f,g,h$を$X$から$Y$への$\cat$の複体の射とする．
    \subparagraph*{反射律}$(s^n=0)$が$f$と$f$の間の
    ホモトピーを与える．

    \subparagraph*{対称律}
    $f$と$g$の間のホモトピーを$s$とするとき，
    $-s$が$g$と$f$の間のホモトピーを与える．

    \subparagraph*{推移律}$f$と$g$の間のホモトピーを$s$, 
    $g$と$h$の間のホモトピーを$t$とする．
    このとき，$s+t$が$f$と$h$の間のホモトピーを与える．
\end{proof}

\begin{Proposition}\label{prop:ht}
    $X,Y\in\CCat$に対し，
    $\Hom_{\CCat}(X,Y)$の加法部分群$\Ht(X,Y)$を
    \begin{equation}
        \Ht(X,Y)\coloneqq\{f\in\Hom_{\CCat}(X,Y)\mid f\simeq 0\}
    \end{equation}
    で定める．複体の射$f\colon X\to Y$と$g\colon Y\to Z$のどちらかが
    0にホモトピックならば，合成$g\circ f$は$0$にホモトピックになる．
    したがって，射の合成は次の写像をひきおこす．
    \begin{align*}
        \Hom_{\CCat}(Y,Z)\times\Ht(X,Y)\to\Ht(X,Z),\\
        \Ht(Y,Z)\times\Hom_{\CCat}(X,Y)\to\Ht(X,Z).
    \end{align*}        
\end{Proposition}
\begin{proof}$f\in\Hom_{\CCat}(X,Y)$, 
    $g\in\Hom_{\CCat}(Y,Z)$とする．
    
    $f\simeq 0$のとき，$s$を0とのホモトピーとすると，
    $g\circ f$と0との間のホモトピーは
    \begin{align*}
        (g^{n-1}\circ s^{n}\colon X^n\to Y^{n-1}\to Z^{n-1})_n
    \end{align*}
    で与えられる．

    $g\simeq 0$のとき，$t$を0とのホモトピーとすると，
    $g\circ f$と0との間のホモトピーは
    \begin{align*}
        (t^{n}\circ f^{n}\colon X^n\to Y^{n}\to Z^{n-1})_n
    \end{align*}
    で与えられる．
\end{proof}

以上の準備のもとで，圏$\cat$のホモトピー圏$\KCat$を次のように定める．
\begin{itemize}
    \item 対象：$\Ob(\KCat)=\Ob(\CCat)$
    \item 射：$\Hom_{\KCat}(X,Y)=\Hom_{\CCat}(X,Y)/\Ht(X,Y)$
\end{itemize}
$\KCat$は加法圏になる．
\begin{proof}[\textbf{$\KCat$が加法圏になることの証明}]
    命題\ref{prop:ht}より，射の合成がきちんと定まる．

    各$X,Y\in\KCat$に対する$\Hom_{\KCat}(X,Y)$のアーベル群構造は
    $\Ht(X,Y)$による剰余群の構造として得られ，
    さらに命題\ref{prop:ht}より，合成の双線型性が得られる．

    零対象と複積は$\CCat$と同様である．
\end{proof}

圏$\KCat$の充満部分圏$\Komp^+(\cat)$, 
$\Komp^-(\cat)$, $\Komp^\mathrm{b}(\cat)$を，
それぞれ$\Comp^+(\cat)$, 
$\Comp^-(\cat)$, $\Comp^\mathrm{b}(\cat)$と同じ対象をとって定める．

\paragraph*{コホモロジー}
$\cat$をアーベル圏とする．
$X\in\CCat$に対し，
\begin{align*}
    Z^k(X)&\coloneqq \Ker d_X^k,\\
    B^k(X)&\coloneqq \im d_X^{k-1},\\
    H^k(X)&\coloneqq \Ker d_X^k/\im d_X^{k-1}
\end{align*}
とおく．$H^k(X)$を複体$X$の$k$次のコホモロジーという．

\begin{Attention*}
    完全列$0\to X\rightarrow Y\rightarrow Z\to0$に対し，
    $Z$を$Y$の商対象といい，$Y/X$とかく．
    一般に単射$i\colon X\hookrightarrow Y$の
    余核$\Coker{i}$を$Y/X$とかける．
\end{Attention*}

任意の$k$に対し$H^k$は$\CCat$から$\cat$への加法関手を定める．
\begin{equation}
    H^k(X)=H^0(X[k])
\end{equation}
$f\colon X\to Y$が0とホモトピックならば，
$H^k(f)\colon H^k(X)\to H^k(Y)$は0. 
よって$H^k$は$\KCat$から$\cat$への関手を定める．

完全列たち
\begin{align*}
    &X^{k-1}\to Z^{k}(X)\to H^{k}(X)\to 0,\\
    &0\to H^{k}(X)\to \Coker{d_X^{k-1}}\to X^{k+1},\\
    &0\to Z^{k-1}(X)\to X^{k-1}\to B^{k}(X)\to 0,\\
    &0\to B^{k}(X)\to X^{k}\to \Coker{d_X^{k-1}}\to 0,\\
    &0\to H^{k}(X)\to \Coker{d_X^{k-1}}\overset{d_X^{k}}{\longrightarrow}Z^{k+1}(X)\to H^{k+1}(X)\to 0.
\end{align*}

\begin{Proposition}
    $0\to X\to Y\to Z\to 0$を$\CCat$の完全列とする．
    このとき，$\cat$における次の長完全列が存在する．
    \begin{equation*}
        \cdots\to 
        H^{n}(X)\to H^{n}(Y)\to H^{n}(Z)
        \overset{\delta}{\longrightarrow} 
        H^{n+1}(X)\to \cdots.
    \end{equation*}
\end{Proposition}

\paragraph*{切り落とし}
$X\in\CCat$と整数$n$に対し，
$\tau^{\leqq n}(X),\tau^{\geqq n}(X)\in\CCat$を
\begin{align}
    \tau^{\leqq n}(X)\colon 
    \cdots\to X^{n-2}\to X^{n-1}\to \Ker{d^n}\to0\to\cdots,\\
    \tau^{\geqq n}(X)\colon 
    \cdots 0\to \Coker{d^{n-1}}\to X^{n+1}\to X^{n+2}\to\cdots
\end{align}
で定める．
このとき，$\CCat$における次の射が得られる．
\begin{align*}
    \tau^{\leqq n}(X)\to X,\quad X\to\tau^{\geqq n}(X),
\end{align*}
また，$n'\leqq n$ならば
\begin{align*}
    \tau^{\leqq n'}(X)\to \tau^{\leqq n}(X),
    \quad 
    \tau^{\geqq n'}(X)\to\tau^{\geqq n}(X).
\end{align*}

\begin{Proposition}
    \begin{enumerate}
        \item 自然な射$H^k(\tau^{\leqq n}(X))\to H^k(X)$は$k\leqq n$ならば同型であり，$k>n$では$H^k(X)=0$である．
        \item 自然な射$H^k(X)\to H^k(\tau^{\geqq n}(X))$は$k\geqq n$ならば同型であり，$k<n$では$H^k(X)=0$である．
    \end{enumerate}
\end{Proposition}

\begin{Attention}
    ホモトピー同値    
\end{Attention}

\section{写像錐}
$\cat$を加法圏とし$f\colon X\to Y$を$\CCat$の射とする．
\begin{Definition}
    $f$の写像錐$M(f)$とは次で定まる$\CCat$の対象である．
    \begin{align*}
        \begin{cases}
            M(f)^n=X^{n+1}\oplus Y^{n},\\
            d^{n}_{M(f)}=\begin{bmatrix*}
                d_{X[1]}^n & 0\\
                f^{n+1} & d_Y^n\\
            \end{bmatrix*}
        \end{cases}
    \end{align*}
\end{Definition}

射$\alpha(f)\colon Y\to M(f)$と$\beta(f)\colon M(f)\to X[1]$を
次で定める．
\begin{align}
    \alpha(f)^{n}=\begin{bmatrix*}
        0\\\id_{Y^n}
    \end{bmatrix*},\\
    \beta(f)^{n}=\begin{bmatrix*}
        \id_{X^{n+1}}&0
    \end{bmatrix*}.
\end{align}

\begin{com*}[4/24]
    「どうして逆に$X\to M(f)$や$M(f)\to Y$じゃないんですか？」
    
    例えば，逆に$\Gamma^n \colon M(f)^n\to Y^n$を$\begin{bmatrix*}
        0&\id_{Y^n}
    \end{bmatrix*}$で定めようとしても，
    \begin{align*}
        \Gamma^{n+1}\circ d_{M(f)}^{n}
        &=\begin{bmatrix*}
            0&\id_{Y^n}
        \end{bmatrix*}\begin{bmatrix*}
            d_{X[1]}^n & 0\\
            f^{n+1} & d_Y^n\\
        \end{bmatrix*}
        =\begin{bmatrix*}
            f^{n+1}&d_Y^n
        \end{bmatrix*},\\
        d_{Y}^n\circ \Gamma^{n}
        &=d_Y^n\circ
        \begin{bmatrix*}
            0&\id_{Y^n}
        \end{bmatrix*}
        =
        \begin{bmatrix*}
            0&d_Y^n
        \end{bmatrix*}
    \end{align*}
    となり，両者は一致しない．
    したがって，$\Gamma$は複体の射にならない．
    $X\to M(f)$も同様である．
    したがって，$M(f)$に対して定まる自然な射は
    $\alpha, \beta$のようにせざるを得ない．
\end{com*}

\begin{Lemma}
    任意の$\CCat$の射$f\colon N\to Y$に対し，
    $\phi\colon X[1]\to M(\alpha(f))$で次の条件をみたすものが存在する．
    \begin{enumerate}
        \item $\phi$は$\KCat$で同型である，
        \item 次の図式は$\KCat$で可換になる：    
        \begin{equation*}
            \vcenter{\xymatrix@C=30pt@R=30pt{
            Y \ar[r]^-{\alpha(f)}
            \ar[d]^-{\id_Y}
            & 
            M(f)
            \ar[r]^-{\beta(f)}
            \ar[d]^-{\id_{M(f)}}
            &
            X[1]
            \ar[r]^-{-f[1]}
            \ar[d]^-{\phi} 
            &
            Y[1]
            \ar[d]^-{\id_{Y[1]}}
            \\
            Y 
            \ar[r]^-{\alpha(f)}
            & 
            M(f)
            \ar[r]^-{\alpha(\alpha(f))}
            &
            M(\alpha(f))
            \ar[r]^-{\beta(\alpha(f))}
            &
            Y[1].
            }}
        \end{equation*}
    \end{enumerate}
\end{Lemma}

%\begin{proof}
%    $\phi$と逆$\psi$を次で定める．
%\end{proof}

\newpage
%\thispagestyle{myheadings}
{\Large{2023/05/01}}
\section{三角圏}\label{ssec:tricat}
$\cat$を加法圏とし，$T\colon\cat\to\cat$を自己関手とする．
$\cat$の三角とは射の列
\begin{equation*}
    X\to Y\to Z\to T(X)
\end{equation*}
のことである．

\begin{Definition}
    三角圏$\cat$は次のデータ\eqref{eq:tricat}, \eqref{eq:family-dt}と
    規則(TR\ref{TR0})--(TR\ref{TR5})からなる．\ref{des:data}
    \begin{description}
        \item[データ] \begin{align}
            %\renewcommand{\labelenumi}{(\ref{ssec:tricat}.{\arabic{enumi}})}
            \text{加法圏}\cat\text{と自己関手}T\colon\cat\to\cat\text{の組},\label{eq:tricat}\\
            \text{特三角 (distinguished triangle) の族．}\label{eq:family-dt}
        \end{align}    
        \item[規則] \label{des:data}
        \begin{quote}
            \begin{enumerate}
                %\setlength{\leftskip}{11pt}
                \setcounter{enumi}{-1}
                \renewcommand{\labelenumi}{(TR{\arabic{enumi}})}
                \item 特三角に同形な三角は特三角である．\label{TR0}
                \item 任意の対象$X\in\cat$に対し，
                    $X\overset{\id_X}{\longrightarrow}X\longrightarrow
                    0\longrightarrow T(X)$は特三角である．\label{TR1}
                \item $\cat$の任意の射$f\colon X\to Y$は
                    特三角$X\overset{f}{\to}Y\to Z\to T(X)$に埋め込める．
                    つまり$Z\in\cat$で$X\overset{f}{\to}Y\to Z\to T(X)$が
                    特三角となるものが存在する．\label{TR2}
                \item $X\overset{f}{\to}
                    Y\overset{g}{\to} 
                    Z\overset{h}{\to} T(X)$が
                    特三角であることと$Y\overset{g}{\longrightarrow}
                    Z\overset{h}{\longrightarrow} T(X)\overset{-T(f)}{\longrightarrow} T(Y)$が
                    特三角であることは同値である．\label{TR3}
                \item ２つの特三角$X\overset{f}{\to}
                Y\to Z\to T(X)$, $X'\overset{f'}{\to}
                Y'\to Z'\to T(X')$に対し，可換図式
                \begin{equation*}
                    \vcenter{\xymatrix
                    @C=26pt@R=26pt
                    {
                    X\ar[r]^-{f}\ar[d]^-{u}
                    &
                    Y\ar[d]^-{v} 
                    \\
                    X'\ar[r]^-{f'}
                    &
                    Y'
                    }}
                \end{equation*}
                は特三角の射に埋め込める．\label{TR4}
                \item（八面体公理）．３つの特三角
                \begin{align*}
                    X\overset{f}{\to}Y\to Z'\to T(X), \\
                    Y\overset{g}{\to}Z\to X'\to T(Y),\\
                    X\overset{g\circ f}{\longrightarrow}
                    Z\to Y'\to T(X)
                \end{align*}
                に対し， \label{TR5}
            \end{enumerate}    
        \end{quote}
    \end{description}
\end{Definition}

\section{圏の局所化}

%\begin{equation}\label{eq:complex}
%    \cdots\rightarrow 
%    X^{n-1}\overset{d_X^{n-1}}{\longrightarrow}
%    X^{n}\overset{d_X^{n}}{\longrightarrow}
%    X^{n+1}\rightarrow\cdots
%\end{equation}

%$\Ob(\Comp(\cat))=\left\{\right\}$

\clearpage
\chapter{層}

\subsection*{概要}

本章では位相空問上の層のアーベル圏とその間のよく用いる関手として，
逆像\(f^{-1}\)，順像\(f_\ast\)，固有順像\(f_!\)，
テンソル積\(\otimes\), 内部 hom \(\HOM\)等を構成する．
その後，第1章の結果を用い層の導来圏 \(\Dompb(X)\)と
上記の関手の導来関手を定義する．
議論の中で，入射層，平坦層，脆弱層，c柔軟層といった概念も導入し，
非特性変形補題やコホモロジーのホモトピー不変性といった後の議論で
用いる層理論の道具も与える．
実際に必要ではないがチェック・コホモロジーついても（簡単に）述べる．
最後に実・複素多様体上に自然に定まる層について復習する．
ここで述べる結果のほんどは昔からよく矢られている．
より詳しくは Bredon[1], Godement[1], Iversen[1] を参照．

\section{前層}

\(X\)を位相空間とする．\(\Op(X)\)で\(X\)の開集合を表す．
\(\Op(X)\)には包含関係によって順序が定まる．
\begin{quote}
    順序関係が定まること：
    \(U\in\Op(X)\)に対し\(U\subset U\)が成り立つ．
    \(U\subset V\), \(V\subset W\)を\(X\)の開集合とする．
    このとき，\(x\in U\)とすると，\(x\in V\)が成り立ち，
    \(x\in W\)となる．
    \(U\subset V\), \(V\subset U\)とすると\(U=V\)である．
\end{quote}
これを次のように圏とみなし，\(\Op(X)\)とかく\footnote{
    原著\cite{KS90}では順序集合の方を\(\mathrm{OP}(X)\)，
    圏とみなしたものを\(\mathfrak{OP}(X)\)と表しているが，
    ここでは同じ記号を用いる．
} (cf. I \S1)．
\begin{equation}
    \begin{cases}
        \Ob(\Op(X))\coloneqq\Op(X)\\
        \Hom_{\Op(X)}(V,U)\coloneqq\begin{cases}
            \{\pt\}\quad&\text{\(V\subset U\)のとき，}\\
            \varnothing\quad&\text{そうでないとき．}
        \end{cases}
    \end{cases}
\end{equation}
ただし，\(V\)と\(U\)は\(X\)の開集合であり，
\(\{\pt\}\)は1点集合である．

\begin{DFN}[前層]
    \(\cat\)を圏とする．
    \(\cat\)に値をとる\(X\)上の\textbf{前層} (presheaf) \(F\)とは，
    \(\Op(X)\)から\(\cat\)への反変関手であり，
    \textbf{前層の射} (morphism of presheaves) とは，
    上記の関手の間の射である．
\end{DFN}

言い換えると，\(X\)上の前層とは\(\Op(X)\)で添字づけられた
射影系ということである．

本書ではアーベル群の前層（と層）のみを考える．
したがって，特に断りのないかぎり，上述の定義で\(\cat=\cAb\)とし，
前層といえばアーベル群の前層を意味する．

よって，前層は各開集合\(U\subset X\)に対してアーベル群\(F(U)\)を
対応させ，各包含写像\(V\subset U\)に対し，
次の条件\eqref{eq212}をみたすアーベル群の射\(
    \rho_{V,U}\colon F(U)\to F(V)
\)を対応させるものである．
\begin{equation}
    \begin{cases}
        \text{任意の開集合\(U\)に対し\(\rho_{U,U}=\id_{F(U)}\)であり,}\\ 
        \text{任意の開集合\(W\subset V\subset U\)に対し\(
            \rho_{W,U}=\rho_{V,U}\circ\rho_{W,V}
        \).}
    \end{cases}\label{eq212}
\end{equation}
このアーベル群の射\(\rho_{V,U}\)を\textbf{制限射} (restriction morphism) と呼ぶ．

前層の射\(\phi\colon F\to G\)の方は群の射\(
    \phi_{U}\colon F(U)\to G(U)
\)であって制限射と両立するものの族ということになる．
すなわち，\(F\)と\(G\)の制限射をどちらも\(\rho_{V,U}\)で表すとき，
全ての開集合\(V\subset U\)に対し次の図式が可換になるということである．
\[\vcenter{\xymatrix@C=26pt@R=26pt{
    F(U)
    \ar[r]^-{\phi_U}
    \ar[d]_-{\rho_{V,U}}
    &
    G(U)\ar[d]^-{\rho_{V,U}} 
    \\
    F(V)\ar[r]_-{\phi_V}
    &
    G(V).
}}\]
前層\(0\)が\(U\mapsto0\)で定まり，
2つの前層\(F\), \(G\)の直和\(F\oplus G\)が\(
    U\mapsto F(U)\oplus G(U)
\)で定まる．
したがって\(X\)上の（アーベル群の）前層と\(X\)上の前層の射の圏は
加法圏である．この圏を\(\PSh(X)\)で表す\footnote{
    原著では\(\mathfrak{PSh}(X)\)と書いている．
}．

\begin{proof}[\textbf{\(\PSh(X)\)が加法圏になること}]
    加法圏の条件\eqref{additive:bilin}--\eqref{additive:biproduct}を
    確かめる．

    \eqref{additive:bilin} 
    \(F\)と\(G\)を\(X\)上の前層とする．
    まず\(\Hom_{\PSh(X)}(F,G)\)が加法群となることを示す．
    \(\Hom_{\PSh(X)}(F,G)\)の加法を定める．
    \(F\)から\(G\)への射\(\phi\)と\(\psi\)に対して
    \(\phi+\psi\)を各開集合\(U\)に対して\(
        \phi_{U}+\psi_{U}
    \)を対応させることで定めると，
    \(\phi+\psi\)が\(F\)から\(G\)への
    射になることが，開集合\(V\subset U\)に対し，
    \begin{align*}
        \rho_{V,U}\circ(\phi_{U}+\psi_{U})
        &=\rho_{V,U}\circ\phi_{U}+\rho_{V,U}\circ\psi_{U}&\text{（\(\cAb\)における射の合成は双線形）}\\
        &=\phi_{V}\circ\rho_{V,U}+\psi_{V}\circ\rho_{V,U}&\text{（\(\phi\)と\(\psi\)は前層の射なので制限射と両立）}\\
        &=(\phi_{V}+\psi_{V})\circ\rho_{V,U}&\text{（\(\cAb\)における射の合成は双線形）}
    \end{align*}
    が成り立つことから分かる．
    
    加法が結合法則をみたすことを示す．
    \(\phi\), \(\psi\), \(\theta\)を\(F\)から\(G\)への射とする．
    開集合\(U\)に対し，
    \begin{align*}
        ((\phi+\psi)+\theta)_U
        &=(\phi+\psi)_{U}+\theta_U\\
        &=(\phi_{U}+\psi_{U})+\theta_U\\
        &=\phi_{U}+(\psi_{U}+\theta_U)\\
        &=\phi_{U}+(\psi+\theta)_U\\
        &=(\phi+(\psi+\theta))_U
    \end{align*}
    である．
    
    加法が可換であることを示す．
    \(\phi\)と\(\psi\)を\(F\)から\(G\)への射とする．
    開集合\(U\)に対し，
    \begin{align*}
        (\phi+\psi)_U
        &=\phi_{U}+\psi_{U}\\
        &=\psi_{U}+\phi_{U}\\
        &=(\psi+\phi)_U
    \end{align*}
    である．
    
    \(\Hom_{\PSh(X)}(F,G)\)の零元を定める．
    \(F\)から\(G\)への射\(0\colon F\to G\)を，
    各開集合\(U\)に対し加法群の零射\(
        0_{U}\colon F(U)\to G(U)
    \)を対応させることで定める．
    \(0\colon F\to G\)が前層の射となることは，\(s\in F(U)\)に対し
    \[
        \rho_{V,U}\circ0_U (s)=\rho_{V,U}(0_{F(V)})
        =0_{G(V)}
        =0_V\circ\rho_{V,U}(s)
    \]
    となることからわかる．
    
    \(0\colon F\to G\)が単位元の条件をみたすことを示す．
    \(\phi\)を\(F\)から\(G\)への射とする．
    開集合\(U\)に対し，
    \begin{align*}
        (\phi+0)_U&=\phi_{U}+0_{U}=\phi_{U},\\
        (0+\phi)_U&=0_U+\phi_U=\phi_{U}
    \end{align*}
    である．
    以上より，\(\Hom_{\PSh(X)}(F,G)\)は加法群となる．

    前層の射の合成が双線形であることを示す．
    \(F,G,H\)を\(X\)上の前層とする．
    \(\phi,\psi\)を\(F\)から\(G\)への射とし，
    \(\theta,\lambda\)を\(G\)から\(H\)への射とする．
    開集合\(U\)に対し，
    \begin{align*}
        (\theta\circ(\phi+\psi))_U
        &=\theta_U\circ(\phi+\psi)_U\\
        &=\theta_U\circ(\phi_U+\psi_U)\\
        &=\theta_U\circ\phi_U+\theta_U\circ\psi_U\\
        &=(\theta\circ\phi)_U+(\theta\circ\psi)_U
    \end{align*}
    であり，
    \begin{align*}
        ((\theta+\lambda)\circ\phi)_U
        &=(\theta+\lambda)_U\circ\phi_U\\
        &=(\theta_U+\lambda_U)\circ\phi_U\\
        &=\theta_U\circ\phi_U+\lambda_U\circ\phi_U\\
        &=(\theta\circ\phi)_U+(\lambda\circ\phi)_U
    \end{align*}
    である．

    \eqref{additive:zero} 
    零対象が存在することを示す．
    上で定めた前層\(0\)が前層になっていることを確認する．
    任意の開集合\(V\subset U\)に対し\(0(U)=0(V)=0\)であり，\(
        \rho_{U,V}=0\colon 0\to 0
    \)で制限射が定まる．とくに\(\rho_{U,U}=\id_{0(U)}\)である．
    また，開集合\(W\subset V\subset U\)に対し，
    \[
        \rho_{W,U}=0=0\circ0=\rho_{W,V}\circ\rho_{V,U}
    \]
    である．
    前層\(0\)が零対象であることを示す．
    \(F\)を\(X\)上の前層とする．
    開集合\(U\)に対し，\(0(U)=0\)は\(\cAb\)の零対象である．
    したがって，
    \(\phi\)を\(0\)から\(F\)への射とすると，
    各開集合\(U\)に対し\(\phi_U=0_U\)となるため\(\phi=0\)である．
    また
    \(\psi\)を\(F\)から\(0\)への射とすると，
    各開集合\(U\)に対し\(\psi_U=0_U\)となるため\(\psi=0\)である．

    \eqref{additive:biproduct}
    直和が存在することを示す．
    上で定めた2つの前層\(F\), \(G\)の直和\(F\oplus G\)が
    前層であることを確認する．
    各開集合\(V\subset U\)に対し，
    \(F\)の制限射を\(F_{V,U}\), \(G\)の制限射を\(G_{V,U}\)で表す．
    このとき，\(F\oplus G\)の制限射\(\rho_{V,U}\)が
    \[
        \rho_{V,U}\coloneqq F_{V,U}\oplus G_{V,U}\colon F(U)\oplus G(U)\to F(V)\oplus G(V)
    \]
    で定まる．制限射の条件を確かめる．各開集合\(U\)に対し，
    \[
        \rho_{U,U}
        =F_{U,U}\oplus G_{U,U}
        =\id_{F(U)}\oplus\id_{G(U)}
        =\id_{F(U)\oplus G(U)}
    \]である．
    開集合\(W\subset V\subset U\)に対し，
    \begin{align*}
        \rho_{W,V}\circ\rho_{V,U}
        &=(F_{W,V}\oplus G_{W,V})\circ(F_{V,U}\oplus G_{V,U})\\
        &=(F_{W,V}\circ F_{V,U})\oplus(G_{W,V}\circ G_{V,U})\\
        &=F_{W,U}\oplus G_{W,U}\\
        &=\rho_{W,U}
    \end{align*}
    である．
    前層\(F\oplus G\)が\(\PSh(X)\)における\(F\)と\(G\)の
    直和であることを示す．
    各開集合\(U\)に対し\(F\oplus G(U)=F(U)\oplus G(U)\)は
    \(\cAb\)における\(F(U)\)と\(G(U)\)の直和である．
    したがって，\(H\)を\(X\)上の前層とすると，
    開集合\(U\)に対し，
    \begin{align*}
        \Hom_{\cAb}(F(U)\oplus G(U),H(U))
        &\cong\Hom_{\cAb}(F(U),H(U))\oplus\Hom_{\cAb}(G(U),H(U))\\
        \Hom_{\cAb}(H(U),F(U)\oplus G(U))
        &\cong\Hom_{\cAb}(H(U),F(U))\oplus\Hom_{\cAb}(H(U),G(U))
    \end{align*}
    が成り立つ．
\end{proof}

\(\phi\colon F\to G\)を前層の射とする．
対応\(U\mapsto \Ker{\phi_U}\)と\(U\mapsto \Coker{\phi_U}\)は
\(X\)上の前層を定める．
これらの前層はそれぞれ\(\PSh(X)\)における\(\phi\)の核と余核となる．
この前層を\(\Ker{\phi}\), \(\Coker{\phi}\)とかく．
\(\PSh(X)\)はアーベル圏の条件\eqref{abel:homTh}をみたす．
したがって，\(\PSh(X)\)はアーベル圏となる．
\begin{proof}[\textbf{\(\PSh(X)\)がアーベル圏になること}]
    アーベル圏の条件\eqref{abel:ker}, \eqref{abel:homTh}を確かめる．

    \eqref{abel:ker} 
    上で定めた2つの前層\(\Ker{\phi}\), \(\Coker{\phi}\)が
    前層になっていることを確認する．

    前層\(\Ker{\phi}\), \(\Coker{\phi}\)が
    \(\PSh(X)\)における\(\phi\)の核と余核となることを確かめる．

    \eqref{abel:homTh} 

\end{proof}









\section{層}

\begin{DFN}[層]
    \(F\)を\(X\)上の（アーベル群の）前層とする．
    \(F\)が
    次の条件をみたすとき，
    \(F\)は\textbf{層} (sheaf) であるという．
    任意の開集合\(U\)と\(U\)の開被覆\(
            \cU=\left(U_i\right)_{i\in I}
    \)に対し，次の列が完全になる．
    \[
        0\to F(U)\overset{d^0}{\to} 
        \prod_{i\in I}F(U_i)\overset{d^1}{\to} 
        \prod_{i,j\in I}F(U_{i}\cap U_j).
    \]ただし，\(d^0\), \(d^1\)は\[
        d^0\colon s\mapsto\left(\mres[s]{U_i}\right)_i,
        \quad
        d^1\colon \left(s_i\right)_i 
        \mapsto\left(
            \mres[s_i]{U_{i}\cap U_j}-\mres[s_j]{U_{i}\cap U_j}
        \right)_{i,j}
    \]で定める．    
    \begin{enumerate}[(S1)]
        \item \(F(U)\)での完全性．\label{shv-1}
        \item \(\prod_{i\in I}^{}F(U_i)\)での完全性．\label{shv-2}
    \end{enumerate}
\end{DFN}

\begin{PRP}\label{prp222}
    \(\phi\colon F\to G\)を層の射とする．
\end{PRP}

\begin{PRP}\label{prp223}
    \(X\)上の前層\(F\)に対し，
    層\(F^{\dag}\)と射\(\theta\colon F\to F^{\dag}\)で
\end{PRP}
\begin{align}
    \left(\Ker\phi\right)_x&=\Ker{\phi_x},\\
    \left(\Coker\phi\right)_x&=\Coker{\phi_x}
\end{align}
\begin{PRP}\label{prp224}
    \(X\)上のアーベル群の層の圏\(\Sh(X)\)はアーベル圏である．
\end{PRP}

\begin{RMK}\label{rmk225}
    命題\ref{prp222}を適用することで，
    層の複体が完全となる条件は群の複体が完全となることであることが分かる．
    とくに，\(\Sh(X)\)から\(\cAb\)への関手\(F\mapsto F_x\)は
    完全関手である．
    他方で，\(\Sh(X)\)から\(\cAb\)への関手\(\Gamma(X;\blk)\)は
    左完全関手である．
\end{RMK}

自然に現れる層は大抵，アーベル群の構造のみならず，
それよりも豊かな構造を備えている．

単位元をもつ環と単位元をもつ環の射の圏を\(\Ring\)で表す\footnote{
    原著では\(\mathfrak{Ring}\)と書いている．
}．\(\Ring\)に値をとる前層を環の前層とよぶ．
環の前層が（\(\cAb\)に値をとる）層となるとき，環の層とよぶ．

\begin{DFN}
    \(\scR\)を\(X\)上の環の層とする．
    \(\scR\)加群\(M\)（あるいは\(\scR\)上の加群の層）とは
    層\(M\)で各開集合\(U\subset X\)に対し，
    \(M(U)\)が左\(\scR(U)\)加群となり，
    各開集合の包含\(V\subset U\)に対し，制限射が加群の構造と両立する，
    すなわち任意の\(s\in\scR(U)\)と\(m\in M(U)\)に対し\(
        \rho_{V,U}(sm)=\rho_{V,U}(s)\cdot\rho_{V,U}(m)
    \)が成り立つもののことである．
\end{DFN}

自明な方法で\(\scR\)加群の射の概念を定義することができる．

\begin{CMT}
    次のようにして射を定める．
    \(\scR\)加群の射\(\phi\colon M\to N\)とは，層の射\(\phi\)で
    \(\scR\)作用と両立する，すなわち任意の\(U\)に対し，
    次の図式が可換になるものをいう．
    \[\vcenter{\xymatrix@C=36pt@R=26pt{
    \scR(U)\times M(U)
    \ar[r]^-{\id_{\scR(U)}\times\phi_U}
    \ar[d]_-{\mu_{U}}
    &
    \scR(U)\times N(U)\ar[d]^-{\mu_{U}} 
    \\
    M(U)\ar[r]_-{\phi_U}
    &
    N(U).
    }}\]
\end{CMT}
\begin{equation}
    \Sh(X)=\Mod(\zz_X).
\end{equation}
\subsection*{解層\(\HOM\)}
\(\scR\)を\(X\)上の環の層とし，\(F\)と\(G\)を\(\scR\)加群とする．

\begin{leftbar}
\begin{DFN}
    次の前層を考える．
    \begin{equation}\label{eq224}
        U\mapsto \Hom_{\mres[\scR]{U}}(\mres[F]{U},\mres[G]{U}).
    \end{equation}
    この前層はアーベル群の層となる（\(\scR\)が
    可換なら\(\scR\)加群の層となる）．

    \eqref{eq224}で定めた層を\(\HOM_{\scR}(F,G)\)とかき，
    \(F\)の\(G\)における（\(\scR\)上の）解層とよぶ．
\end{DFN}
\end{leftbar}


\begin{proof}[\textbf{層になることの証明}]
    (S\ref{shv-1}) 
    \(U\)を\(X\)の開集合とし，
    \(\left(U_i\right)_{i\in I}\)を\(U\)の開被覆とする．
    次の列が完全になることを示す．
    \[
        0\to \Hom_{\mres[\scR]{U}}(\mres[F]{U},\mres[G]{U})
        \to \prod_{i\in I}\Hom_{\mres[\scR]{U_i}}(\mres[F]{U_i},\mres[G]{U_i}).
    \]
    層の射\(\phi\colon \mres[F]{U}\to \mres[G]{U}\)が
    各\(U_i\)上\(\mres[\phi]{U_i}=0\)となるとする．
    このとき\(\phi=0\)となることを示す．
    \(V\)を\(U\)の開集合とし，
    \(s\)を\(\mres[F]{U}(V)\)の切断とする．
    \((V\cap U_i)_i\)は\(V\)の開被覆となる．
    いま\(\phi_V(s)\)は\(\mres[G]{U}(V)\)の切断で，
    各\(U_i\cap V\)上\[
        \mres[\phi_V(s)]{V\cap U_i}
        =\phi_{V\cap U_i}(\mres[s]{V\cap U_i})
        =0
    \]をみたす．
    したがって，層\(\mres[G]{U}\)の条件 (S\ref{shv-1}) を\(V\subset U\), 
    \(\left(V\cap U_i\right)_i\)に対して用いると
    \(\phi_{V}(s)=0\)が成り立つ．
    よって，\(\phi_V=0\)が各\(V\in\Op(U)\)が成り立つので\(\phi=0\)である．

    (S\ref{shv-2}) 
    \(U\)を\(X\)の開集合とし，
    \(\left(U_i\right)_{i\in I}\)を\(U\)の開被覆とする．
    次の列が完全になることを示す．
    {\small\[
        \Hom_{\mres[\scR]{U}}(\mres[F]{U},\mres[G]{U})
        \to \prod_{i\in I}\Hom_{\mres[\scR]{U_i}}(\mres[F]{U_i},\mres[G]{U_i}).
        \to \prod_{i, j\in I}\Hom_{\mres[\scR]{U_i\cap U_j}}(\mres[F]{U_i\cap U_j},\mres[G]{U_i\cap U_j}).
    \]}
    層の射の族\(\left(
        \phi_{i}\colon \mres[F]{U_i}\to \mres[G]{U_i}
    \right)_{i\in I}\)が各\(U_{i}\cap U_{j}\)で\(
        \mres[\phi_i]{U_i\cap U_j}=\mres[\phi_j]{U_i\cap U_j}
    \)をみたすとする．
    このとき，層の射\(\phi\colon \mres[F]{U}\to\mres[G]{U}\)で
    各\(i\in I\)に対し\(\mres[\phi]{U_i}=\phi_i\)をみたすもの
    が存在することを示す．
    \(V\subset U\)を開集合とする．
    \((V\cap U_i)_i\)は\(V\)の開被覆である．
    \(\phi_V\colon\mres[F]{U}(V)\to\mres[G]{U}(V)\)を以下のように定める．
    \(s\in\mres[F]{U}(V)\)を切断とする．
    \(\left(
        \phi_{i,V\cap U_i}(\mres[s]{V\cap U_i})
    \right)\in\prod_{i}\mres[G]{U}(V\cap U_i)\)は
    各\(i,j\in I\)に対して
    \begin{align*}
        \mres[{
            \phi_{i,V\cap U_i}\left(\mres[s]{V\cap U_i}\right)
        }]{V\cap U_i\cap U_j}
        &=
        \mres[{
            \left(\mres[\phi_i]{U_i\cap U_j}\right)
        }]{V\cap U_i\cap U_j}\left(\mres[s]{V\cap U_i\cap U_j}\right)\\
        &=
        \mres[{
            \left(\mres[\phi_j]{U_i\cap U_j}\right)
        }]{V\cap U_i\cap U_j}\left(\mres[s]{V\cap U_i\cap U_j}\right)\\
        &=
        \mres[{
            \phi_{j,V\cap U_j}\left(\mres[s]{V\cap U_i}\right)
        }]{V\cap U_i\cap U_j}
    \end{align*}
    をみたす．
    したがって層\(\mres[G]{U}\)の条件 (S\ref{shv-2}) から，
    \(t\in\mres[G]{U}(V)\)で各\(i\in I\)に対して\(
        \mres[t]{V\cap U_i}
        =\phi_{i,V\cap U_i}(\mres[s]{V\cap U_i})
    \)をみたすものがただひとつ存在する．これを\(\phi_V(s)\)と定める．
    \(V\)に対して\(\phi_V\)を対応させる操作は，
    開集合の包含\(W\subset V\)に対し\(
        \mres[\phi_V(s)]{W}=\phi_W(\mres[s]{W})
    \)をみたすので，制限射と可換になり層の射を定める．
    この\(\phi\)は各\(V\cap U_i\)で\[
        \mres[\phi]{V\cap U_i}(\mres[s]{V\cap U_i})
        =\mres[\phi(s)]{V\cap U_i}
        =\phi_{i,V\cap U_i}(\mres[s]{V\cap U_i})
    \]をみたすので，各\(i\in I\)に対し\(
        \mres[\phi]{U_i}=\phi_i
    \)をみたす．
\end{proof}

一般に，自然な射
\begin{equation}
    \left(\HOM_{\scR}(F,G)\right)_{x}
    \to
    \Hom_{\scR_{x}}(F_{x},G_{x})
\end{equation}
は単射でも全射でもない．構成から次が成り立つ．
\begin{equation}
    \Gamma\left(X;\HOM_{\scR}(F,G)\right)
    =\Hom_{\scR}(F,G).
\end{equation}
\begin{proof}
    \begin{align*}
        \Gamma\left(X;\HOM_{\scR}(F,G)\right)
        &=\Hom_{\mres[\scR]{X}}(\mres[F]{X},\mres[G]{X})\\    
        &=\Hom_{\scR}(F,G).    
    \end{align*}        
\end{proof}

\subsection*{テンソル積\(\ttens\)}
\begin{leftbar}
    \begin{DFN}
        前層\(U\mapsto F(U)\ttens[\scR(U)]G(U)\)に
        対応する層を\(F\ttens[\scR]G\)とかき，
        \(F\)と\(G\)の（\(\scR\)上の）テンソル積とよぶ．
    \end{DFN}    
\end{leftbar}

\begin{equation}
    \left(F\ttens[\scR]G\right)_x
    =F_x\ttens[\scR_x]G_x.
\end{equation}
\begin{equation}
    F\ttens[\scR]\left(H\ttens[\scS]G\right)
    \cong
    \left(F\ttens[\scR]H\right)\ttens[\scS]G.
\end{equation}

\begin{leftbar}
    \begin{PRP}[テンソル・Hom 随伴]\label{prp229}
        \begin{align}
            \HOM_{\scR}\left(H\ttens[\scS]F,G\right)
            &\cong
            \HOM_{\scR}\left(F,\HOM_{\scS}(H,G)\right)\label{eq229}\\
            &\cong
            \HOM_{\scS}\left(H,\HOM_{\scR}(F,G)\right).\notag
        \end{align}
    \end{PRP}
\end{leftbar}
\begin{leftbar}
    \begin{CRL}
        命題\ref{prp229}と同じ状況のとき，次の自然な射が存在する．
        \begin{align}
            \HOM_{\scR}(F,G)&\ttens[\scS]F\to G\quad\text{in \(\Mod(\scR)\)},\label{eq2210}\\
            \HOM_{\scR}(F,G)\ttens[\scS]H
            \to&\HOM_{\scR}\left(F,G\ttens[\scS]H\right)
            \quad\text{in \(\Mod(\scS)\)},\label{eq2211}\\
            \HOM_{\scR}(F,G)
            \to
            \HOM_{\scR^{\op}}&(
                \HOM_{\scR}(G,\scR),\HOM_{\scR}(F,\scR)
            )\quad\text{in \(\Mod(\scS)\)}.\label{eq2212}
        \end{align}
    \end{CRL}
\end{leftbar}
\begin{proof}
    (i) 
    \eqref{eq229}で\(H=\HOM_{\scR}(F,G)\in\Mod(\scS)\)とすると
    \[
        \HOM_{\scR}\left(\HOM_{\scR}(F,G)\ttens[\scS]F,G\right)
        \cong
        \HOM_{\scS}\left(\HOM_{\scR}(F,G),\HOM_{\scR}(F,G)\right)
    \]
    が成り立つ．
    \(X\)での切断を見ると
    \[
        \Hom_{\scR}\left(\HOM_{\scR}(F,G)\ttens[\scS]F,G\right)
        \cong
        \Hom_{\scS}\left(\HOM_{\scR}(F,G),\HOM_{\scR}(F,G)\right)
    \]
    右辺に属する恒等射\(1_{\HOM_{\scR}(F,G)}\)の
    像が\eqref{eq2210}の射\[
        \HOM_{\scR}(F,G)\ttens[\scS]F\to G
    \]を定める．

    (ii) 
    \eqref{eq2210}に\(H\)をテンソルすると
    \[
        \HOM_{\scR}(F,G)\ttens[\scS]H\ttens[\scS]F\to G\ttens[\scS]H\tag*{(\(\natural\))}
    \]
    が定まる．
    \eqref{eq229}を\(F=F\), \(G=G\ttens[\scS]H\), 
    \(H=\HOM_{\scR}(F,G)\ttens[\scS]H\)に適用して
    \begin{align*}
        &\HOM_{\scR}\left(\HOM_{\scR}(F,G)\ttens[\scS]H\ttens[\scS]F,G\ttens[\scS]H\right)\\
        \cong
        &\HOM_{\scS}\left(\HOM_{\scR}(F,G)\ttens[\scS]H,\HOM_{\scR}(F,G\ttens[\scS]H)\right)
    \end{align*}
    が成り立つ．\(X\)での切断を取ると
    \begin{align*}
        &\Hom_{\scR}\left(\HOM_{\scR}(F,G)\ttens[\scS]H\ttens[\scS]F,G\ttens[\scS]H\right)\\
        \cong
        &\Hom_{\scS}\left(\HOM_{\scR}(F,G)\ttens[\scS]H,\HOM_{\scR}(F,G\ttens[\scS]H)\right)
    \end{align*}
    上の (\(\natural\)) はこの左辺に属する．
    この像が\eqref{eq2211}の射\[
        \HOM_{\scR}(F,G)\ttens[\scS]H
        \to
        \HOM_{\scR}\left(F,G\ttens[\scS]H\right)
    \]
    を定める．

    (iii) 
    \(\rmD_{\scR}F\coloneqq\HOM_{\scR}(F,\scR)\)と略記する．
    このとき，
    \(\rmD_{\scR}\)は\(\Mod(\scR)\)から\(\Mod(\scR^\op)\)への
    関手を定める．
    \eqref{eq2210}で\(F=G\), \(G=\scR\)とすると自然な射
    \[
        \rmD_{\scR}G\ttens[\scS]G=\HOM_{\scR}(G,\scR)\ttens[\scS]G\to \scR
    \]
    が定まる．これに関手\(\HOM_\scR(F,\blk)\)を適用すると
    \[
        \HOM_{\scR}\left(
            F,\rmD_{\scR}G\ttens[\scS]G
        \right)
        \to\HOM_\scR(F,\scR)=\rmD_{\scR}F
    \]
    が得られる．
    これに関手\(\HOM_{\scR^{\op}}(\blk,\rmD_{\scR}F)\)を
    適用すると
    \[
        \HOM_{\scR^{\op}}(\rmD_{\scR}F,\rmD_{\scR}F)
        \to
        \HOM_{\scR^{\op}}\left(
            \HOM_{\scR}\left(
                F,\rmD_{\scR}G\ttens[\scS]G
            \right),\rmD_{\scR}F
        \right)
    \]
    が得られる．
    いま\eqref{eq2211}で\(H=\rmD_{\scR}G\)とした
    \begin{align*}
        \HOM_{\scR}(F,G)\ttens[\scS]\rmD_{\scR}G
        \to
        \HOM_{\scR}\left(F,G\ttens[\scS]\rmD_{\scR}G\right)
        \mathbin{{\underset{\text{\(\scS\)の可換性}}{\simar}}}
        \HOM_{\scR}\left(F,\rmD_{\scR}G\ttens[\scS]G\right)%\quad\text{（\(\scS\)の可換性を用いた）}
    \end{align*}
    に関手\(
        \HOM_{\scR^{\op}}(\blk,\rmD_{\scR}F)
    \)を適用することで
    \begin{align*}
        &\HOM_{\scR^{\op}}\left(
            \HOM_{\scR}\left(
                F,\rmD_{\scR}G\ttens[\scS]G
            \right),\rmD_{\scR}F
        \right)\\
        \to&
        \HOM_{\scR^{\op}}\left(
        \HOM_{\scR}(F,G)\ttens[\scS]\rmD_{\scR}G
        ,\rmD_{\scR}F\right)
    \end{align*}
    という射が得られるので，これを合成すれば
    \begin{align*}
        \HOM_{\scR^{\op}}(\rmD_{\scR}F,\rmD_{\scR}F)
        &\to
        \HOM_{\scR^{\op}}\left(
            \HOM_{\scR}\left(
                F,\rmD_{\scR}G\ttens[\scS]G
            \right),\rmD_{\scR}F
        \right)\\
        &\to
        \HOM_{\scR^{\op}}\left(
        \HOM_{\scR}(F,G)\ttens[\scS]\rmD_{\scR}G
        ,\rmD_{\scR}F\right)
    \end{align*}
    という射が定まる．
    最後の層は\eqref{eq229}より，
    \[
        \HOM_{\scS}\left(
            \HOM_{\scR}(F,G),\HOM_{\scR^{\op}}(\rmD_{\scR}G,\rmD_{\scR}F)
        \right)
    \]
    と同型である．\(X\)での切断を取れば
    \[
        \Hom_{\scR^{\op}}(\rmD_{\scR}F,\rmD_{\scR}F)
        \to
        \Hom_{\scS}\left(
            \HOM_{\scR}(F,G),\HOM_{\scR^{\op}}(\rmD_{\scR}G,\rmD_{\scR}F)
        \right)
    \]
    が得られるので，
    この射による\(1_{\rmD_{\scR}F}\)の値が\eqref{eq2212}の射
    \[
        \HOM_{\scR}(F,G)\to\HOM_{\scR^{\op}}(\HOM_{\scR}(G,\scR),\HOM_{\scR}(F,\scR))
    \]
    を定める．
\end{proof}






\section{層の演算}
\subsection*{部分集合から定まる関手}
\(X\)を位相空間とする．
\(X\)の部分集合\(Z\)から定まる関手を考える．
\(Z\)を\(X\)からの誘導位相で部分位相空間とみなし，
\(j\colon Z\hookrightarrow X\)を
包含写像とする．
\subsubsection*{制限の一般的な定義}
\(F\in\Sh(X)\)に対し，
\begin{align}
    F\rvert_Z&\coloneqq j^{-1}F,\\
    \Gamma(Z;F)&\coloneqq\Gamma\left(Z;j^{-1}F\right)    
\end{align}
とおく．\(Z\)が開集合のとき，元の定義に一致する．
\begin{proof}[\textbf{元の定義に一致することのチェック}]
    \(U\subset Z\)を開集合とすると，
    \begin{align*}
        \Gamma\left(U;j^{-1}F\right)
        &=\indlim[j(U)\subset V]F(V)\\
        &=F(j(U))=F(U)=F\rvert_Z(U)
    \end{align*}
    となる．
\end{proof}

自然な射\(\Gamma(X;F)\to\Gamma(Z;\mres[F]{Z})\)が存在する．
\(s\in\Gamma(X;F)\)のとき，その\(\Gamma(Z;\mres[F]{Z})\)での
像を\(\mres[s]{Z}\)とかき，\(s\)の\(Z\)への制限とよぶ．
\begin{proof}[\textbf{射の構成}]
    順像・逆像随伴の単位\(
        \varepsilon\colon\id\to j_{\ast}j^{-1}
    \)を\(F\)に適用すると射\(
        \varepsilon_F\colon F\to j_{\ast}j^{-1}F
    \)が得られる．
    これに\(X\)から1点への連続写像\(a_X\colon X\to\{\pt\}\)から
    定まる順像関手\({a_X}_{\ast}\colon \Sh(X)\to\cAb\)を
    施すことで
    \[
        \Gamma(X;F)\cong {a_X}_{\ast}F
        \overset{{a_X}_{\ast}(\varepsilon_F)}{\longrightarrow} {a_X}_{\ast}j_{\ast}j^{-1}F
        \cong {a_Z}_{\ast}(\mres[F]{Z})
        \cong\Gamma(Z;\mres[F]{Z})
    \]
    が得られる．
\end{proof}

\subsubsection*{切り落とし}
\paragraph{ふつうの順像を用いた閉集合での定義}
\(Z\)が閉集合であるときを考える．
このとき，\(F\in\Sh(X)\)に対し，
\[
    F_Z\coloneqq j_{\ast}j^{-1}F
\]
とおく．\footnote{\label{CMT:supp-cut}
    池ノート\cite{Ike21}や竹内\cite{Tak17}だと，
    固有順像 (\ref{ssec:pdimg}項) を
    定義してから，\(j_{!}j^{-1}F\)で切り落としを定義している．
    閉集合からの包含写像に対しては\(j_!=j_\ast\)であり，
    これらの定義は一致する．
}
このとき，自然な射\(F\to \mres[F]{Z}\)が定まる．
さらに，
\begin{equation}\label{eq2313}
    \begin{cases}
        \mres[F_{Z}]{Z}\cong \mres[F]{Z},\\
        \mres[F_{Z}]{X-Z}\cong 0
    \end{cases}\tag{2.3.13}
\end{equation}
が成り立つ．とくに\(x\in X\)ならば\((F_Z)_x=F_x\)であり，
\(x\notin Z\)ならば\((F_Z)_x=0\)である．
\begin{proof}
    注意\ref{rmk253}を先取りするのがよいと思う．
    \(j\colon Z\hookrightarrow X\)は固有写像である．
    実際，\(Z\)の閉集合は\(X\)の閉集合でもあるので\(j\)は閉写像だし，
    1点\(x\in X\)の逆像\(j^{-1}(x)\)は，
    \(x\in Z\)のとき\(\{x\}\)，\(x\notin Z\)のとき\(\varnothing\)で，
    どちらも有限集合なのでコンパクトである．
    よって，注意\ref{rmk253}より，
    \(Z\)上の層\(G\)と\(X\)の点\(x\in X\)に対して，
    \[
        \left(j_{\ast}G\right)_x
        \cong
        \Gamma(j^{-1}(x);\mres[G]{j^{-1}(x)})
    \]
    が成り立つ．
    
    \eqref{eq2313}の1つ目の式を示す．
    自然な射\(F\to F_Z\)に\(j^{-1}\)を適用して
    \(Z\)上の層の射\(\mres[F]{Z}\to\mres[F_Z]{Z}\)を得る．
    これらの\(x\in Z\)における茎が同型であることを示す．
    \begin{align*}
        \left(\mres[F]{Z}\right)_x
        &\cong \left(j^{-1}F\right)_x\\
        &\cong F_{j(x)}=F_x
    \end{align*}
    である．一方
    \begin{align*}
        \left(\mres[F_Z]{Z}\right)_x
        &\cong \left(j^{-1}j_{\ast}j^{-1}F\right)_x\\
        &\cong \left(j_{\ast}j^{-1}F\right)_x\\
        &\cong \Gamma(j^{-1}(x);\mres[j^{-1}F]{j^{-1}(x)})\\
        &\cong \Gamma(\{x\};\mres[j^{-1}F]{\{x\}})\\
        &\cong F_x
    \end{align*}
    である．よって，両者は一致する．
    %\textcolor{red}{最後の同型はひょっとするとハウスドルフ性がいるかも}

    \eqref{eq2313}の2つ目の式を示す．
    \(i\colon X-Z\hookrightarrow Z\)を\(X-Z\)から\(X\)への
    包含写像とする．
    \(F_Z\)に\(i^{-1}\)を適用して
    \(X-Z\)上の層\(\mres[F_Z]{X-Z}\)を得る．
    これの\(x\in X-Z\)における茎を計算する．
    \begin{align*}
        \left(\mres[F_Z]{X-Z}\right)_x
        &\cong \left(i^{-1}j_{\ast}j^{-1}F\right)_x\\
        &\cong \left(j_{\ast}j^{-1}F\right)_x\\
        &\cong \Gamma(j^{-1}(x);\mres[j^{-1}F]{j^{-1}(x)})\\
        &\cong \Gamma(\varnothing;\mres[j^{-1}F]{\varnothing})\\
        &\cong 0.
    \end{align*}
    よって，\eqref{eq2313}が成り立つ．
\end{proof}
\begin{proof}[\textbf{別証明\((\mathbf{2024/05/20})\)}]
    注意\ref{rmk253}の先取りは要らない．
    次の主張が一般に成り立つ．
    \begin{leftbar}
    \begin{STT}\label{STT21}
        位相空間\(X\)の部分集合\(Z\)に\(X\)の相対位相を入れて
        部分空間とする．
        \(j\colon Z\hookrightarrow X\)を包含写像とする．
        \(Z\)上の全ての層\(G\)に対して\(
            j^{-1}j_{\ast}G\cong G
        \)が成り立つ．
    \end{STT}
    \end{leftbar}
    \begin{center}        
    \begin{minipage}{.9\textwidth}
    %\begin{redleftbar}
    \begin{proof}[\textbf{主張\(\mathbf{\ref{STT21}}\)の証明}]
        順像と逆像に関する随伴の余単位\(
            \eta\colon j^{-1}j_{\ast}\to1
        \)を\(G\)に適用して，\(Z\)上の層の射\[
            \eta_G\colon j^{-1}j_{\ast}G\to G
        \]を得る．これらが茎ごとに同型であることを示す．
        \(x\in Z\)とする．
        \begin{align*}
            \left(j^{-1}j_{\ast}G\right)_x
            &\cong
            \left(j_{\ast}G\right)_{j(x)}\\
            &=
            \left(j_{\ast}G\right)_{x}\\
            &=
            \indlim[U\in I_{x}^{X}]G\left(j^{-1}(U)\right)\\
            &=
            \indlim[U\in I_{x}^{X}]G\left(U\cap Z\right)\\
            &=
            \indlim[V\in I_{x}^{Z}]G\left(V\right)\\
            &= G_{x}.
        \end{align*}
        したがって，層として\(
            j^{-1}j_{\ast}G\cong G
        \)である．
    \end{proof}
    %\end{redleftbar}
    \end{minipage}
    \end{center}
    この主張を用いると\eqref{eq2313}の前半は次のようになる．
    \begin{align*}
        \mres[F_Z]{Z}
        &=j^{-1}j_{\ast}j^{-1}F\\
        &\underset{\eta_{j^{-1}F}}{\simar}j^{-1}F=\mres[F]{Z}
    \end{align*}
    である．

    \eqref{eq2313}の後半には次の主張を用いる．
    \begin{leftbar}
    \begin{STT}\label{STT22}
        \(Z\)を\(X\)の閉集合とし，\(j\colon Z\hookrightarrow X\)を
        包含写像とする．このとき\(Z\)上の層\(G\)に対し，次が成り立つ．
        \[\left(j_{\ast}G\right)_x
        \cong\begin{cases}
            G_x& (x\in Z),\\
            0&(x\in X-Z).
        \end{cases}\]
    \end{STT}
    \end{leftbar}
    \begin{center}
        \begin{minipage}{.9\textwidth}
        %\begin{redleftbar}
            \begin{proof}[\textbf{主張\(\mathbf{\ref{STT22}}\)の証明}]
                \(x\in Z\)の場合は主張\ref{STT21}で示した．
                \(x\in X-Z\)の場合の主張（閉集合であることが必要）を示す．
                \(x\in X-Z\)に対し，
                \begin{align*}
                    \left(j_{\ast}G\right)_{x}
                    &=\indlim[U\in I_{x}^X]G(j^{-1}(U))\\
                    &=\indlim[U\in I_{x}^X]G(U\cap Z)\\
                    &=\indlim[V\in I_{x}^Z]G(V)\\
                    &=\indlim[V\in \varnothing]G(V)\\
                    &=0
                \end{align*}
                である．
            \end{proof}
        %\end{redleftbar}
        \end{minipage}
     \end{center}        
    
    以上の主張を用いると後半の証明は以下のようになる．
    \(i\colon X-Z\hookrightarrow X\)を開集合の包含写像とする．
    \(x\in X-Z\)に対し，
    \begin{align*}
        \left(\mres[F_Z]{X-Z}\right)_{x}
        &=\left(i^{-1}j_{\ast}j^{-1}F\right)_x\\
        &=\left(j_{\ast}j^{-1}F\right)_{i(x)}\\
        &=\left(j_{\ast}j^{-1}F\right)_{x}\\
        &=0
    \end{align*}
    よって，\eqref{eq2313}が成り立つ．
\end{proof}

\paragraph{開集合での定義}
\(Z\)が\(X\)の局所閉集合の場合でも，
\eqref{eq2313}をみたす\(X\)上の層\(F_Z\)を構成することができる．
まず，開集合の場合に構成する．
\(Z\)が\(X\)の開集合のとき，\(F_Z\)を次のように定める．
\[
    F_Z\coloneqq \Ker\left(F\to F_{X-Z}\right).
\]
これは\eqref{eq2313}をみたす．
\begin{proof}
    1つ目の式：\(\iota\colon F_Z\to F\)を
    核の普遍性から定まる射とする．
    \(i\colon Z\hookrightarrow X\)を包含写像とする．
    \(i^{-1}\)を\(\iota\)に適用することで\[
        i^{-1}(\iota)\colon i^{-1}F_Z\to i^{-1}F
    \]が定まる．この射が茎ごとの同型を誘導することを示す．
    \(x\in Z\)とする．\[
        \left(i^{-1}F\right)_{x}=F_{i(x)}=F_x
    \]である．また，閉集合\(X-Z\)と\(x\in Z\)に対し
    主張\ref{STT22}の2つ目の式が成り立つことに注意すると，
    \begin{align*}
        \left(i^{-1}F_Z\right)_{x}
        &=\left(F_Z\right)_{i(x)}=\left(F_Z\right)_x\\
        &=\Ker\left(F\to F_{X-Z}\right)_{x}\\
        &=\Ker\left(F_{x}\to \left(F_{X-Z}\right)_{x}\right)\\
        &=\Ker\left(F_{x}\to 0\right)\\
        &=F_{x}
    \end{align*}
    となる．よって\(
        \mres[F_{Z}]{Z}\cong \mres[F]{Z}
    \)が成り立つ．

    2つ目の式：\(x\in X-Z\)とし，
    \(j\colon X-Z\hookrightarrow X\)を包含写像とする．
    閉集合\(X-Z\)と\(x\in X-Z\)に対し今度は
    主張\ref{STT22}の1つ目の式が成り立つことに注意すると，
    \begin{align*}
        \left(\mres[F_Z]{X-Z}\right)_{x}
        &=\left(j^{-1}F_Z\right)_{x}=\left(F_Z\right)_{j(x)}\\
        &=\left(F_Z\right)_{x}\\
        &=\Ker\left(F\to F_{X-Z}\right)_{x}\\
        &=\Ker\left(F_{x}\to \left(F_{X-Z}\right)_{x}\right)\\
        &=\Ker\left(F_{x}\to F_x\right)\\
        &=0
    \end{align*}
    である．よって\(\mres[F_Z]{X-Z}=0\)が成り立つ．
\end{proof}
\paragraph{局所閉集合での定義}
閉集合と開集合に対して切り落としが定義できたので，
局所閉集合\(Z\)に対して\(F_Z\)を定義する．
一般に\(X\)の開集合\(U\)と閉集合\(A\)を用いて\(Z=U\cap A\)と
かいておく．
このとき\(F_Z\)を
\[
    F_Z\coloneqq \left(F_U\right)_A
\]
とおく．（\(F_Z\)が\eqref{eq2313}をみたすことの証明は以下の命題）
この定義は\(U\)と\(A\)の選び方に依らない（以下の命題の(i)を参照）．

関手\((\blk)_Z\colon F\mapsto F_Z\)の主な性質を列挙する．
\begin{leftbar}
\begin{PRP}\label{PRP236}
    \(Z\)を\(X\)の局所閉部分集合とし，\(F\)を\(X\)上の層とする．
    \begin{enumerate}[(i)]
        \item 層\(F_Z\)は\eqref{eq2313}をみたす．
        さらに\(X\)上の層で\eqref{eq2313}をみたすものは
        すべて\(F_Z\)に同型である．
        \item 関手\((\blk)_Z\colon F\mapsto F_Z\)は完全である．
        \item \(Z'\)を\(Z\)とは別の\(X\)の局所閉部分集合とする．
        このとき次が成り立つ．\[
            \left(F_Z\right)_{Z'}=F_{Z\cap Z'}.
        \]
        \item \(Z\)が\(X\)の閉集合であるとし，
        \(j\colon Z\hookrightarrow X\)を\(Z\)の\(X\)への
        包含写像とする．このとき，\[F_Z=j_{\ast}j^{-1}F\]が成り立つ．
        \item \(Z'\)を\(Z\)の閉部分集合とする（\(Z\)は局所閉）．
        このとき，次の列は完全である．\[
            0\to F_{Z-Z'}\to F_Z\to F_{Z'}\to 0.
        \]
        \item \(Z_1\)と\(Z_2\)を\(X\)の閉部分集合とする．
        このとき列\[
            0\to F_{Z_1\cup Z_2}\underset{\alpha}{\to}
            F_{Z_1}\oplus F_{Z_2}\underset{\beta}{\to}
            F_{Z_1\cap Z_2}\to0
        \]は完全である．
        ただし\(\alpha=\left(\alpha_1,\alpha_2\right)\)と\(
            \beta=\left(\beta_1,-\beta_2\right)
        \)はそれぞれ自然な射\(F_{Z_1\cup Z_2}\to F_{Z_i}\)と\(
            F_{Z_i}\to F_{Z_1\cap Z_2}
        \)（\(i=1,2\)）から引きおこされるものである．
        \item \(U_1\)と\(U_2\)を\(X\)の開部分集合とする．
        このとき列\[
            0\to F_{U_1\cap U_2}\underset{\gamma}{\to}
            F_{U_1}\oplus F_{U_2}\underset{\delta}{\to}
            F_{U_1\cup U_2}\to0
        \]は完全である．
        ただし\(\gamma=\left(\gamma_1,\gamma_2\right)\)と\(
            \delta=\left(\delta_1,-\delta_2\right)
        \)はそれぞれ自然な射\(F_{U_1\cap U_2}\to F_{U_i}\)と\(
            F_{U_i}\to F_{U_1\cup U_2}
        \)（\(i=1,2\)）から引きおこされるものである．
    \end{enumerate}
\end{PRP}
\end{leftbar}
\begin{proof}
    (i) 
    まず\(F_Z\)が\eqref{eq2313}をみたすことを示す．
    1つ目の式を示す．
    \begin{align*}
        \mres[\left(F_U\right)_A]{U\cap A}
        &=\mres[{\left(\mres[\left(F_U\right)_A]{A}\right)}]{U\cap A}\\
        &=\mres[{\left(\mres[F_U]{A}\right)}]{U\cap A}\\
        &=\mres[\left({\mres[F_U]{U}}\right)]{U\cap A}\\
        &=\mres[\left({\mres[F]{U}}\right)]{U\cap A}\\
        &=\mres[F]{U\cap A}
    \end{align*}
    である．2つ目の式\(\mres[\left(F_Z\right)]{X-Z}=0\)を示す．
    \(X-Z=(X-U)\cup(X-A)\)の各点\(x\)での茎が0になることを示せばよい．
    \begin{enumerate}[(a)]
        \item \(x\in X-A\)のとき，\(
            \left(\left(F_U\right)_A\right)_{x}=0
        \)である．
        \item \(x\notin X-A\)すなわち\(x\in A\)のとき，\(x\in X-U\)であるから，
        \[
            \left(\left(F_U\right)_A\right)_{x}
            =\left(F_U\right)_{x}
            =0
        \]である．したがって，\(\mres[\left(F_Z\right)]{X-Z}=0\)である．
    \end{enumerate}
    
    次に，\eqref{eq2313}をみたす\(X\)上の層\(F'\)が\(F_Z\)に
    同型であることを示す．
\end{proof}
\subsection{固有順像}\label{ssec:pdimg}

\(f_!\colon\Sh(X)\to\Sh(Y)\)
について，\(f\)がプロパーなら\(f_!\cong f_\ast\)である．
つまり，脚注 \ref{CMT:supp-cut}の主張は
もっと一般に\(f\)がプロパーなら成り立つ．

\section{分解}
\section{局所コンパクト空間上の層}
位相空間\(X\)が局所コンパクト性など，何らかの有限性をもつ場合，
新しい種類の層と関手が関心の的になる．
本節では，断りを入れる場合（命題\ref{prp251}や注意\ref{rmk253}など）を
除き，空間はすべて局所コンパクトであること，
よってとくにハウスドルフであることを仮定する．

\begin{PRP}\label{prp251}
    \(X\)を（局所コンパクトとは限らない）位相空間とする．
    \(Z\)を\(X\)の部分空間，\(F\)を\(X\)上の層とする．
    自然に定まる射
    \[
        \varPsi\colon\indlim[U]\Gamma(U;F)\to \Gamma(Z;F)
    \]
    を考える．
    ただし，\(U\)は\(X\)における\(Z\)の開近傍を走る．
    このとき，以下が成り立つ．
    \begin{enumerate}[(i)]
        \item \(\varPsi\)は単射である．
        \item \(X\)がハウスドルフで\(Z\)がコンパクトならば，\(\varPsi\)は同型である．
        \item \(X\)がパラコンパクトで\(Z\)が閉集合ならば，\(\varPsi\)は同型である．
    \end{enumerate}
\end{PRP}
証明に入る前に命題\ref{prp251}に登場した概念を復習する．
パラコンパクト空間\(X\)とは，
ハウスドルフ空間で，\(X\)の各開被覆\(\left(U_i\right)_{i\in I}\)に
対し，\(X\)の開被覆\(\left(V_j\right)_{j\in J}\)で，
\(\left(U_i\right)_{i\in I}\)よりも細かく（すなわち，
各\(j\in J\)に対し\(V_j\subset U_i\)となる\(i\in I\)が存在し），
局所有限であるものがとれるものをいうのであった．
また，次の事実が成り立つのであった．
\(X\)がパラコンパクトで\(\left(U_i\right)_{i\in I}\)が
局所有限な開被覆であるとすると，
開被覆\(\left(V_i\right)_{i\in I}\)で
各\(i\in I\)に対し\(\bar{V}_i\subset U_i\)となるもの
が存在する．
パラコンパクト空間の閉部分集合はパラコンパクトである．
無限遠で可算な局所コンパクト空間や距離空間もパラコンパクトである．
\begin{proof}
    命題の証明．．．
\end{proof}
\(f\colon Y\to X\)を連続写像とする（\(X\)と\(Y\)は
局所コンパクトでなくとも良い）．
\(f\)が固有であるとは，\(f\)が閉（すなわち，
\(Y\)任意の閉集合の像が\(X\)の閉集合）であり，
各ファイバーが相対ハウスドルフ（すなわち，
各ファイバーの相異なる任意の2点に対し，
\(Y\)における近傍で互いに交わらないものが存在する）かつ
コンパクトであることをいう．
\(X\)と\(Y\)が局所コンパクトである場合，\(f\)が固有となるのは，
\(X\)の任意のコンパクト集合の\(f\)による逆像がコンパクトとなるときである．

\begin{PRP}\label{prp252}
    \(X\)と\(Y\)を局所コンパクト空間（とくにハウスドルフ空間）とし，
    \(f\colon Y\to X\)を連続写像，\(G\)を\(Y\)上の層とする．
    このとき，\(x\in X\)に対して定まる標準的な射
    \[
        \alpha\colon \left(f_{!}G\right)_x
        \to
        \Gamma_{c}(f^{-1}(x);\mres[G]{f^{-1}(x)})
    \]
    は同型である．
\end{PRP}

\begin{RMK}\label{rmk253}
    \(f\colon Y\to X\)を局所コンパクトとは限らない
    空間\(Y\)と\(X\)の間の連続写像とし，\(G\)を\(Y\)上の層とする．
    \(f\)が\(\supp(G)\)上固有であると仮定する．
    命題\ref{prp252}の証明におけると同様の議論により，
    \(x\in X\)に対して定まる標準的な射
    \[
        \left(f_{\ast}G\right)_x
        \to
        \Gamma(f^{-1}(x);\mres[G]{f^{-1}(x)})
    \]
    が同型であることが分かる．
\end{RMK}







\section{弱大域次元}
アーベル層の圏はアーベル圏になる．
したがって層の導来圏が考えられる．

\(\cdot\otimes\cdot\)の導来関手を考えたいが，
テンソルに関する複体が有界になるとは限らないので，
平坦分解の長さが有限になるという仮定をおく．

\begin{PRP}
    \(A\)を環とする．
    \begin{enumerate}
        \item 自由加群は射影加群である．
        
        \item 射影加群は自由加群の自由加群の直和因子である．
        
        \item 射影加群は平坦加群である．
        
        \item \(n\geqq0\)を整数とする．
            次の条件(a)--\((\text{b})^{\op}\)は同値である．
            \begin{enumerate}[(a)]
                \item 任意の\(j>n\), \(N\in\Mod(A^\op)\), 
                \(M\in\Mod(A)\)に対し，\(\Tor_j^A(N,M)=0\)
                \item 任意の\(M\in\Mod(A)\)に対し，分解\[
                    0\to P^n\to\dots\to P^0\to M\to0\quad\text{(\(P^j\)は平坦)}
                    \]が存在する．
                \item[\((\text{b})^{\op}\)]\setlength{\leftskip}{10pt}
                任意の\(M\in\Mod(A^\op)\)に対し，分解\[
                    0\to P^n\to\dots\to P^0\to M\to0\quad\text{(\(P^j\)は平坦)}
                \]が存在する．
            \end{enumerate}
    \end{enumerate}
\end{PRP}
\begin{proof}
    \begin{enumerate}
        \item \(M\)を自由加群とする．左\(A\)加群の全射
        \(g\colon N\twoheadrightarrow N'\)に対し，\[
            g_\ast\colon\Hom_A(M,N)\to\Hom_A(M,N') 
            \quad\text{in \(\Mod(\zz)\)}
        \]が全射であることを示す．
        \(\psi\colon M\to N'\)を\(A\)加群の射とする．
        \(I\)を\(M\cong A^{\oplus I}\)となる添字集合とすると
        任意の\(m\in M\)は，
        \(M\)の生成系\((m_i)\)と\((a_i)_i\in A^{\oplus I}\)を
        用いて，\(m=\sum_{i\in I}a_im_i\)とかける．
        このとき，\[
            \psi(m)=\sum_{i}a_i\psi(m_i)\in N'
        \]であり，\(g\)が全射なので，\(n\in N\)で\[
            g(n)=\psi(m)=\sum_{i}a_i\psi(m_i),
            \quad
            \psi(m_i)=g(n_i)
        \]となるものがある．
        この\((n_i)_i\)に対して，\(\phi\colon M\to N\)を
        \[
            \phi(m_i)=n_i
        \]で定めると，
        \[
            \left(g_\ast(\phi)\right)(m_i)=g\circ\phi(m_i)=g(n_i)=\psi(m_i)
        \]となる．
        \item \(P\)を射影加群とする．
        自由加群\(A^{\oplus I}\)と
        全射\(p\colon A^{\oplus I}\twoheadrightarrow P\)が存在する．
        実際，\(I= P\)として，
        \(p\)を\(p((a_x)_{x\in P})=\sum_{x\in P}a_xx\)と
        定めればよい．\(Q=\Ker p\)とすると，\[
            0\to Q\hookrightarrow A^{\oplus I}\twoheadrightarrow P\to0
        \]は完全列である．
        このとき，\(P\)が射影加群であることから，
        \(\id_P\)に対して，\(u\colon P\to A^{\oplus I}\)で
        \[p_\ast(u)=p\circ u=\id_P\]となる者が存在する．
        したがって，上の完全列は分裂し，
        \(A^{\oplus I}\cong P\oplus Q\)となる．
        \item まず「自由\(\Rightarrow\)平坦」を示す．\(F=A^{\bigoplus I}\)を自由加群とし，\[
            0\to N_1\to N_2\to N_3\to0
        \]を右\(A\)加群の完全系列とする．\[
            0\to N_1\otimes A^{\bigoplus I}\to N_2\otimes A^{\bigoplus I}\to N_3\otimes A^{\bigoplus I}\to0
        \]において，\[
            N_1\otimes A^{\bigoplus I}\cong N_1^{\bigoplus I},\quad
            N_2\otimes A^{\bigoplus I}\cong N_2^{\bigoplus I}
        \]であり，\(j\colon N_1\to N_2\)は単射なので，\[
            \bigoplus_{i\in I}j_i\colon N_1^{\bigoplus I}\to N_2^{\bigoplus I}
        \]で
    \end{enumerate}
\end{proof}

\clearpage
\section{非特性変形補題}
\begin{leftbar}
\begin{PRP}[{\cite[Prop. 2.5.1]{KS90}}]\label{PRP2.5.1}
    \(X\)を位相空間とし，\(Z\)を部分空間とする．
    \(F\)を\(X\)上の層とし，自然な射
    \[
        \psi\colon\indlim[U\in I_Z]\Gamma(U;F)\to\Gamma(Z;F)
    \]を考える．

    (i) 
    \(\psi\)は単射である．

    (ii)
    \(X\)がハウスドルフで\(Z\)がコンパクトならば，\(\psi\)は同型である．
\end{PRP}
\end{leftbar}
\begin{leftbar}
    \begin{PRP}[{\cite[Prop. 1.12.4]{KS90}}]\label{PRP1.12.4}
        \[
            \phi_k\colon H^k(\indlim X)\to\prolim H^k(X_n)
        \]
        について，\(H^{i-1}(X_n)\)がML条件を満たすならば，\(\phi_k\)は一対一対応である．
    \end{PRP}
\end{leftbar}
    
\begin{leftbar}
\begin{PRP}[{\cite[Prop. 1.12.6]{KS90}}]\label{PRP1.12.6}
    \((X_s,\rho_{s,t})\)を実数を添字とする射影系とする．
    \[
        \lambda_s\colon X_s\to\prolim[r<s]X_r,
        \quad
        \mu_s\colon\indlim[t>s]X_t\to X_s
    \]
    がどちらも単射（全射）ならば，すべての実数\(s_0\leqq s_1\)に対し，
    \(\rho_{s_0,s_1}\colon X_{s_1}\to X_{s_0}\)は単射（全射）となる．
\end{PRP}
\end{leftbar}

\begin{leftbar}    
\begin{PRP}[{\cite[Prop. 2.7.2, 非特性変形補題]{KS90}}]
    \(X\)をハウスドルフ空間とし，\(F\in\Domp^+(\zz_X)\)とする．
    また，\((U_t)_{t\in\rr}\)を\(X\)の開集合の族で次の条件(i)--(iii)をみたすものとする．
    \begin{enumerate}[(i)]
        \item 任意の実数\(t\)に対し，\(\bigcup_{s<t}U_s=U_t\)が成り立つ．
        \item 任意の実数\(s\leqq t\)に対し，\(\overline{U_t-U_s}\cap\supp F\)はコンパクト集合である．
        \item 実数\(s\)に対して\(Z_s=\bigcap_{t>s}\overline{U_t-U_s}\)とおくとき，
        任意の実数\(s\leqq t\)と任意の点\(x\in Z_s-U_t\)に対して\(\left(\RG_{X-U_t}(F)\right)_x=0\)が成り立つ．
    \end{enumerate}
    このとき，任意の実数\(t\)に対して，次の同型が成り立つ．
    \[
        \RG\left(\bigcup_{s\in\rr}U_s;F\right)\overset{\sim}{\longrightarrow}\RG(U_t;F)
    \]
\end{PRP}
\end{leftbar}
\begin{proof}
    次の条件を考える．
    \begin{align*}
        (a)_k^s\colon\quad \indlim[t>s]H^k(U_t;F)\simar H^k(U_s;F)\\
        (b)_k^t\colon\quad \prolim[s<t]H^k(U_s;F)\simra H^k(U_t;F)        
    \end{align*}
    任意の実数\(s\)と任意の整数\(k\)に対して\((a)_k^s\)が，
    任意の実数\(t\)と任意の整数\(k<k_0\)に対して\((b)_k^t\)が成り立つとする．
    このとき，\(k_0\)に対し，\((b)_{k_0}^t\)が成り立つことを示す．
    命題\ref{PRP1.12.6}より，
    （\((a)_k^s\)の方が\(\mu_s\)，\((b)_k^t\)の方が\(\lambda_t\)として）
    各次数\(k<k_0\)と各実数\(s\leqq t\)に対し，
    \begin{equation}
        H^k(U_t;F)\simar H^k(U_s;F)
    \end{equation}
    が成り立つ．
    このとき，
    \(t\)を固定して，
    射影系\(\left(
        H^{k_0-1}\left(U_{t-\frac{1}{n}};F\right)
    \right)_{n\in\nn}\)を考えると，これはML条件をみたす．
    \begin{center}
        \begin{minipage}{.9\textwidth}
            \begin{redleftbar}
                \(\because)\) 
                任意の\(n\in\nn\)に対し，
                \[
                    \rho_{n,p}
                    \left(
                        H^{k_0-1}\left(U_{t-\frac{1}{p}};F\right)
                        \to 
                        H^{k_0-1}\left(U_{t-\frac{1}{n}};F\right)
                    \right)
                \]
                はすべて同形なので，当然安定．
            \end{redleftbar}
        \end{minipage}
     \end{center}        
    よって，命題\ref{PRP1.12.4}より\((b)_{k_0}^t\)が従う．
    \(k\)に関する帰納法により，
    どの\(t\in\rr\)と\(k\in\zz\)に対しても\((b)_{k}^t\)が成り立つ．
    \begin{center}
        命題2.7.1を
        \(\left(H^{k}\left(U_{n};F\right)\right)_{n\in\nn}\)に
        用いると←わかってない
    \end{center}
    \(k\)に関する帰納法で，定理の結論
    \[
        \RG\left(\bigcup_{s\in\rr}U_s;F\right)\overset{\sim}{\longrightarrow}\RG(U_t;F)
    \]
    が従う．

    \subparagraph*{\((a)_k^s\)の証明}
    \(X\)を\(\supp{F}\)におきかえて，どの実数\(s\leqq t\)に対しても
    \(\overline{U_t-U_s}\)はコンパクトとしてよい．
    次のd.t.を考える\footnote{
        \cite[(2.6.32)]{KS90}のd.t.
        \[
            \RG_{Z'}(F)\to\RG_{Z}(F)\to\RG_{Z-Z'}(F)\underset{+1}{\longrightarrow}
        \]
        を用いる．但し，\(Z\)は\(X\)の局所閉集合，\(Z'\)は\(Z\)の閉集合である．
    }．
    \[
        \RG_{(X-U_t)}(F)\rvert_{Z_s}\to
        \RG_{(X-U_s)}(F)\rvert_{Z_s}\to
        \RG_{(U_t-U_s)}(F)\rvert_{Z_s}
        \overset{+1}{\longrightarrow}.
    \]
    仮定(iii)より，左と真ん中の2つは0なので，
    d.t.の性質から，\(\RG_{(U_t-U_s)}(F)\rvert_{Z_s}=0\)となる．
    したがって，任意の\(k\in\zz\)と\(t\geqq s\)に対し，
    \begin{align*}
        0&=H^k(Z_s;\RG_{(U_t-U_s)}(F))\\
        &=\indlim[U\supset Z_s]H^k(U\cap U_t;\RG_{X-U_s}(F))
    \end{align*}
    となる．
    \begin{center}
        \begin{minipage}{.9\textwidth}
        \begin{redleftbar}
            \(\RG_{U_t-U_s}(F)\)は\(X\)上の層で，
            それを\(Z_s\)に制限した\(\RG_{U_t-U_s}(F)\rvert_{Z_s}\)は\(Z_s\)上の層である．
            \(Z_s\)での大域切断\(\RG(Z_s;\RG_{U_t-U_s}(F)\rvert_{Z_s})\)のコホモロジーをとっているので，
            \cite[Notations 2.6.8]{KS90}の２番目の記号を用いることになる．

            \(Z_s\)はハウスドルフ空間\(X\)の
            コンパクト集合\(\overline{U_t-U_s}\)の
            共通部分として表されているので，コンパクトである（\(X\)の置き換えがここに効いている）．
            したがって，\cite[Remark 2.6.9 (ii)]{KS90}の場合に当てはまり，
            そこでの記号を用いて書くと
            \[H^j(Z;F)\simeq\indlim[U\in I_Z]H^j(U;F)\]が成り立つ．
            これが上の式の2つ目の変形．
            詳しく書くと，
            \begin{align*}
                H^k(Z_s;\RG_{U_t-U_s}(F))
                &=\indlim[U\in I_Z]H^k(U;\RG_{U_t-U_s}(F))\\
                &=\indlim[U\in I_Z]H^k(U\cap U_t;\RG_{X-U_s}(F))
            \end{align*}
            ここで，2つ目の変形は次のように考える．
            \(U_t-U_s\)に台を持つ層の\(U\)上の切断は\(U\cap U_t\)上で切断を考えても同じ．
            台の方も，\(U\)が\(Z_s\)に十分近ければ\(X-U_s\)で考えても同じ．
        \end{redleftbar}
    \end{minipage}
        
    \end{center}
\end{proof}

\setcounter{section}{8}
\section{実・複素多様体上の層の例}
ここで層の例をいくつか挙げる．
そのうちの大部分については11章で詳しい説明を与えることにする．

\subsection{層\(\Conti_X^0\)}
位相空間\(X\)において，
\(X\)の開集合\(U\)に対し複素数値連続関数の空間\(C^0(U)\)を
対応させ，制限射を通常の関数の制限で定めた
前層は明らかに層になる．
この層を\(\Conti_X^0\)で表す．
定数層\(\zz_X\)は\(\zz\)値関数のなす\(\Conti_X^0\)の部分層とみなせる．

\subsection{層\(\Lloc[dx]\)}
\(U\)をユークリッド空間\(\rr^n\)の開集合とし，
\(L^1(U;dx)\)を\(\rr^n\)上のルベーグ測度\(dx\)に関する\(U\)上の
可積分関数の空間とする．
前層\(U\mapsto L^1(U;dx)\)は層ではない．
この前層から誘導された\(\rr^n\)上の層を
\(\Lloc[dx]\)
で表す．

\subsection{環付き空間}
環付き空間\((X,\scA_X)\)とは
位相空間\(X\)に環の層\(\scA_X\)をあわせたものをいう．
環付き空間の射
\(f\colon(Y,\scA_Y)\to(X_,\scA_X)\)
は連続写像\(f\colon X\to Y\)に
環の層の射\(f^{-1}\scA_X\to\scA_Y\)をあわせたものをいう．
\(A\)が環で\(\scA_X\)が\(A\)代数の層である（すなわち
層の射\(A_X\to\scA_X\)が存在する）とき，
\((X,\scA_X)\)を\(A\)環付き空間と呼ぶ．

\subsection{\(C^\alpha\)多様体}
\(\alpha\)を整数\(0\leqq\alpha<\infty\)
または\(\alpha=\omega\)とする．
\(\rr^n\)上の複素数値\(C^\alpha\)級関数（\(C^\omega\)のとき
実解析的関数）の層を\(C^\alpha_{\rr^n}\)で表す．
\(n\)次元実\(C^\alpha\)多様体\(M\)とは，
無限遠点で可算な局所コンパクト空間\(M\)と環の層\(C^\alpha_M\)の組で，
\(\cc\)環付き空間として\((\rr^n,C^\alpha_{\rr^n})\)と
局所的に同型であるものをいう．

\(\dim X\)（または\(\dim_\rr X\)）で実多様体\(X\)の次元を表す．
文献によっては層\(C^\omega_M\)を\(\scA_M\)で表すことも多い．

微分幾何学の基礎的な課程としてGuillemin-Pollack\cite{GP74}を挙げる．

\subsection{向きづけ，微分形式，密度}\label{ssec:ori-form-dens}
\(C^0\)多様体\(M\)上の層として，向きづけ層\(\ori _M\)を
考えることも必要になってくる．
\(\ori_M\)は\(\zz_M\)と局所的に同型な層であり，
\(M\)の向きが存在する場合，
その向きを選ぶことと同型\(\ori_M\cong\zz_M\)を選ぶことが
同義となるようなものである．
\(\ori_M\)については次章で詳しくしらべる．

いま，\(\alpha=\infty\)または\(\alpha=\omega\)とし，
\(p\)を整数とする．\(C^\alpha_M\)を係数にもつ\(p\)次微分形式
の層を\(C_M^{\alpha,(p)}\)とおく．
また外微分を\(
    d\colon C_M^{\alpha,(p)}\to C_M^{\alpha,(p+1)}
\)で表す．

\((x_1,\dots,x_n)\)が\(M\)上の局所座標系であるとする．
このとき，\(p\)形式\(f\)は次の形にただ一通りに表されるのであった．
\[
    f=\sum_{\lvert I\rvert=p}^{}f_Idx_I,
\]ここに，\(
    I=\left\{i_1,\dots,i_p\right\}\subset\{1,\dots,n\}
\), \((i_1<i_2<\dots<i_p)\), 
\(dx_I=dx_{i_1}\wedge\dots\wedge dx_{i_p}\)で，
\(f_I\)は\(C^\alpha_M\)の切断である．
このとき，\[
    df=\sum_{i=1}^{n}\sum_{\lvert I\rvert=p}^{}\frac{\partial f_I}{\partial x_i}dx_i\wedge dx_I
\]となるのであった．
もうひとつ層を導入する．
\[
    \scV_M^\alpha
    \coloneqq
    C^{\alpha,(n)}_M\otimes\ori_M
%    \quad
 %   \text{}
\]（\(\alpha=\infty\)または\(\alpha=\omega\)）とおき，
\(M\)上の\(C^\alpha\)密度の層とよぶ．

コンパクト台をもつ\(C^\infty\)密度は積分することができる．
\(\int_M\cdot\)で積分写像
\begin{equation}
    \int_M\cdot\colon\Gamma_c(M;\scV_M^\infty)\to\cc \label{eq:int}
\end{equation}を表す．
\(C^{\alpha,(p)}_M\)と\(\scV_M^\alpha\)は
\(C^\alpha_M\)加群の層である．

「1の分割」の存在から，
層\(C^\alpha_M\)，\(C^{\alpha,(p)}\)，\(\scV_M^\alpha\)は
\(\alpha\neq\omega\)に対してはc柔軟であることが従う．
層\(C^\omega_M\)，\(C^{\omega,(p)}\)，\(\scV_M^\omega\)は
関手\(\Gamma(M;\cdot)\)に対し非輪状，
すなわち\(j>0\)に対し\(H^j(M;C^\omega_M)=0\)である．
Grauert\cite{G58}を参照．

\subsection{分布と超関数}\label{ssec:dist-hyper}
\(C^\infty\)多様体\(M\)上には
シュワルツ分布の層\(\Db_M\)が自然に定まる
（Schwartz\cite{S66}，de Rham\cite{R55}を参照）．
\(\Db_M\)はc柔軟層であり，
\(\Gamma_c(M;\Db_M)\)は\(\Gamma(M;\scV_M^\infty)\)の
双対位相線形空間である．
ただし，\(\Gamma(M;\scV_M^\infty)\)には
フレシェ空間としての自然な位相を入れている．

\(C^\omega\)多様体\(M\)上にも同様に
佐藤超関数の層\(\scB_M\)が自然に定まる（佐藤\cite{Sa59}を参照）．
\(\scB_M\)は脆弱層であり，\(\Gamma_c(M;\scB_M)\)は
\(\Gamma(M;\scV_M^\omega)\)の
双対位相線形空間である．
ただし，\(\Gamma(M;\scV_M^\omega)\)には
DFS空間としての自然な位相を入れている
（MartineauとSchapiraに詳細な解説がある）．
しかし，佐藤による構成は純粋にコホモロジーによるものである．
後ほど\ref{ssec:sato}項で復習する．

積分写像\eqref{eq:int}はペアリング
\begin{equation}
    \begin{array}{ccc}
        {\Gamma(M;C_M^\infty)\times\Gamma_c(M;\scV_M^\infty)}&\longrightarrow&\cc\\
        \rotatebox{90}{$\in$}&&\rotatebox{90}{$\in$}\\
        (f,g)&\longmapsto&\dip\int_Mfg
    \end{array}
\end{equation}
を定める．
このペアリングから\(C^\infty_M\)から\(\Db_M\)への層の射がひきおこされ，
この射が単射であることも示せる．
さらに，実解析多様体\(M\)の上では，
単射\(\Gamma(M;\scV_M^\omega)\to\Gamma(M;\scV_M^\infty)\)から
射\(\Db_M\to\scB_M\)が引き起こされ，こちらも単射であることがわかる．

分布係数の\(p\)形式の層\(
    \Db_M^{(p)}
    \coloneqq 
    C^{\infty,(p)}_M\otimes_{C^\infty_M}\Db_M
\)や超関数係数の\(p\)形式の層\(
    \scB_M^{(p)}
    \coloneqq 
    C^{\omega,(p)}_M\otimes_{C^\omega_M}\scB_M
\)も定義することができる．
\(\Db_M^{(p)}\)はc柔軟層，\(\scB_M^{(p)}\)は脆弱層である．


\subsection{ド・ラーム複体}

\(M\)を\(C^\infty\)多様体とする．\emph{ポアンカレの補題}より，
系列
\begin{equation}\label{eq:dR-cpx}
    0\to\cc_M
    \to C^{\infty,(0)}_M
    \underset{d}{\to}\dots\to
    C^{\infty,(n)}_M\to0
\end{equation}
は完全である．
したがって，\(\cc_M\)はc柔軟層のなす複体と擬同形である．
\begin{equation}\label{eq:qis-dR}
    \cc_M\underset{\text{qis}}{\longrightarrow}
    \left(0\to C^{\infty,(0)}_M
    \underset{d}{\to}\dots\to
    C^{\infty,(n)}_M\to0\right).
\end{equation}
これによってコホモロジー群\(H^j(M;\cc_M)\)や\(H^j_c(M;\cc_M)\)を
具体的に計算することができる．
例えば，\eqref{eq:qis-dR}に\(\RG(M;\cdot)\)を適用することで，
同型
\begin{equation}
    \RG(M;\cc_M)
    \cong
    \left(0\to \Gamma\left(M;C^{\infty,(0)}_M\right)
    \underset{d}{\to}\dots\to
    \Gamma\left(M;C^{\infty,(n)}_M\right)\to0\right)
\end{equation}
が得られる．
\(C^{\infty}_M\)を\(\Db_M\)に取り替えても同じ結果が得られる．
\(M\)が実解析的なら，
\(C^{\infty}_M\)を\(C^{\omega}_M\)や\(\scB_M\)に
取り替えることで同じ結果が従う．
しかし，\(C^{\omega}_M\)はc柔軟ではなく
\(\Gamma(M;\cdot)\)非輪状でしかないので注意が必要である．
他方，\(\scB_M\)はc柔軟であるのみならず脆弱でもあるので，
これを用いて\(M\)の局所閉集合\(Z\)に対する
相対コホモロジー群\(H^j_Z(M;\cc_M)\)を具体的に計算することができる．

複体\eqref{eq:dR-cpx}を\(M\)のド・ラーム複体と呼ぶ．





\subsection{複素多様体}

\(\scO_{\cc^n}\)で\(\cc^n\)上の正則関数のなす層を表す．
\(n\)次元複素多様体\(X\)は\(\cc\)環付き空間\((X,\scO_X)\)で
\((\cc^n,\scO_{\cc^n})\)と局所的に同型であるものをいう．

複素多様体\(X\)の次元を\(\dim_\cc X\)で表す．
複素微分幾何学の基本的な概念についての参考文献としてWellsを挙げる．
解析幾何学のさらなる展開についてはBanica-Stanasilaの本を勧める．

\(\scO_X^{(p)}\)で\(X\)上の正則\(p\)形式のなす層を表し，
\({\partial}\)で正則微分を表す．
\(\varOmega_X\)を次のように定めることも多い．
\begin{equation}
    \varOmega_X\coloneqq \scO_X^{(p)}\otimes\ori_X
\end{equation}
ただし\(\ori_X\)は\(X\)上の向きづけ層である．
ポアンカレの補題は正則関数係数の場合にも成り立ったので
層\(\cc_M\)は複体
\begin{equation}\label{eq:c-dR-cpx}
    0\to \scO_X^{(0)}
    \underset{\partial}{\to}\dots\to
    \scO_X^{(n)}\to0
\end{equation}
と擬同形である．

\subsection{ドルボー複体}

\((X,\scO_X)\)を複素多様体とする．
\(\left(\overline{X},\scO_{\overline{X}}\right)\)
で位相空間\(X\)に\(X\)上の反正則関数のなす層
\(\scO_{\overline{X}}\)をあわせたものを表す．
（ただし\(f\colon X\to \cc\)が反正則であるとは，
\(\cc\)上の複素共役写像との合成が正則であることであった．）
従って\(\left(\overline{X},\scO_{\overline{X}}\right)\)も複素多様体となる．

\(X^\rr\)で\(X\)を実解析多様体とみなしたものを表す．
\(X^\rr\)を\(X\times\overline{X}\)の対角集合と同一視すれば，
\(X\times\overline{X}\)は\(X^\rr\)の複素化であるといえる．
実際，
\begin{equation}
    \left.\scO_{X\times\overline{X}}\right\rvert_{X^\rr}
    \cong
    C^\omega_{X^\rr}
\end{equation}
である．
\(X\times\overline{X}\)上で\(X\)の正則微分\(\partial\)と
\(\overline{X}\)の\(\overline{\partial}\)を考えることができる．
よって，\(X\times\overline{X}\)上の微分\(d\)は\(
    d={\partial}+\overline{\partial}
\)と分解できる．
この分解から層\(C^{\alpha,(r)}_{X^\rr}\)
（\(\alpha=\infty\)または\(\alpha=\omega\)とする）
の分解
\[
    C^{\alpha,(r)}_{X^\rr}
    =\bigoplus_{p+q=r}C^{\alpha,(p,q)}_{X}
\]
が引き起こされる．
ただし，\(C^{\alpha,(p,q)}_{X}\)は
\(X\)上の\((p,q)\)形式のなす層である．
\(X\)の局所正則座標系\((z_1,\dots,z_n)\)において，
\(C^{\alpha,(p,q)}_{X}\)の切断\(f\)は次の形にただ一通りに表される．
\[
    f=\sum_{\lvert I\rvert=p,\lvert J\rvert=q}^{}f_{I,J}dz_I\wedge d\overline{z}_J
\]
ただし，\ref{ssec:ori-form-dens}項と同様に，
\(dz_I=dz_{i_1}\wedge\dots\wedge dz_{i_p}\)，
\(  
    d\overline{z}_J
    =d\overline{z}_{j_1}\wedge\dots\wedge d\overline{z}_{j_q}
\)である．
とくに
\[
    \partial{f}=
    \sum_{I}^{}\sum_{J}^{}\sum_{i=1}^{n}\frac{\partial{f_{I,J}}}{\partial{z_i}}
    dz_i\wedge dz_I\wedge d\overline{z}_J
\]である．
ドルボーの補題によれば，
複体
\[
    0\to\scO_X^{(p)}\to C^{\infty,(p,0)}_X
    \underset{\bar{\partial}}{\to}
    C^{\infty,(p,1)}_X\to\dots\to
    C^{\infty,(p,n)}_X\to0
\]
は完全である．
\(C^{\infty,(p,q)}_X\)を
\(C^{\omega,(p,q)}_X\)や\(\Db^{(p,q)}_X\)，
或いは\(\scB^{(p,q)}_X\)に取り替えた場合にも
同様の結果がある．
特に\(\scO_X^{(p)}\)は脆弱層の複体
\begin{equation}\label{eq:sato-reol}
    0\to\scB_X^{(p,0)}
    \underset{\bar{\partial}}{\to}
    \dots\to\scB^{(p,n)}_X\to0
\end{equation}
と擬同形である（Komatsu, Schapiraを参照）．
この複体\eqref{eq:sato-reol}は入射\(\scO_X\)加群の複体である
ことがGolovinによって示されている．






\subsection{\(\scO_X\)上の演算}

\(f\colon Y\to X\)を複素多様体の間の射とする．
環付き空間の射の定義より，
\(f\)は層の射\(f^{-1}\scO_X\to\scO_Y\)をひきおこす．
もうひとつ，導来圏\(\Dompl(\cc_X)\)では射
\begin{equation}\label{eq:mor-Ox}
    \Rder f_!\varOmega_Y[\dim_\cc Y]
    \to
    \varOmega_X[\dim_\cc X]
\end{equation}
が定義される．
この射は以下のように表される．

\(n=\dim_\cc X\)，\(m=\dim_\cc Y\)，\(l=m-n\)とおく．
射\(f^{-1}C^{\infty,(m-p,m-q)}_X\to C^{\infty,(m-p,m-q)}_Y\)
から双対性より射
\begin{equation}\label{eq:mor-Ox-Db}
    f_!\Db_Y^{(p,q)}\otimes\ori_Y\to
    \Db_X^{(p-l,q-l)}\otimes\ori_X
\end{equation}
が定まる．よって，\eqref{eq:mor-Ox-Db}と
\(\varOmega_Y\)，\(\varOmega_X\)のドルボー分解から
\eqref{eq:mor-Ox}が誘導される．

















\subsection{\(\scO_X\)のコホモロジー}
H\"ormanderが\(\scO_X\)のコホモロジーについて詳しく調べている．
\(\varOmega\)が\(\cc^n\)の開集合であるとする．
任意の\(j>0\)に対し\(H^j(\varOmega;\scO_X)=0\)であるとき，
\(\varOmega\)は擬凸であるという．
たとえば，凸領域は擬凸であり，\(n=1\)なら，任意の領域が擬凸となる．
最後の主張は次のように一般化できる．
\begin{equation}
    \begin{cases}
        \text{\(\varOmega\)が\(\cc^n\)の開集合ならば，任意の\(j\geqq n\)に対し，}\\
        \quad H^j(\varOmega;\scO_{\cc^n})=0\\
        \text{が成り立つ．}
    \end{cases}\label{eq:psudo-convex}
\end{equation}
ドルボー分解と，方程式\(
    \dip \sum_{j=1}^{n}
    \frac{\partial}{\partial z_j}
    \frac{\partial}{\partial \bar{z}_j}f=g
\)が\(\Gamma(\varOmega;C^\infty_{\rr^{2n}})\)で
いつでも解けるという事実とを用いた\eqref{eq:psudo-convex}の証明
がMalgrange[1]で述べられている．

\(X\)を\(n\)次元複素多様体とし，\(Z\)を\(X\)の局所閉部分集合とする．
\(x\in Z -\Int{Z}\)ならば，\(j\notin[1,n]\)に対し
\begin{equation}
    H_Z^j(\scO_X)_x=0
\end{equation}
となる．
実際，\(j=0\)の場合，これは「解析接続の原理」そのものであり，
\(j>n\)の場合は，\eqref{eq:psudo-convex}から，
或いは(2.9.9)から従う
（すなわち\(\scO_X\)の脆弱次元は\(n\)である）．

Martineauと柏原による\(H^j_Z(\scO_X)\)が消滅するための規準がある(SKKも参照)．
\(X=\cc^n\)とし\(Z\)を\(X\)の部分閉凸集合とする．\(x\in Z\)のとき，
\begin{equation}\label{eq:rel-vanish}
    \begin{cases}
        \text{\(x\)を通る\(d\)次元アフィン空間\(L\)で，\(L\cap Z\)が}\\
        \text{\(L\)における\(x\)の近傍となるものが存在しないとき}\\
        \quad H^j_Z(\scO_X)_x=0\quad\text{for \(j\leqq n-d\).}
    \end{cases}
\end{equation}

\subsection{正則関数の境界値}

\(\varOmega\)を\(C^2\)境界をもつ\(\cc^n\)の強擬凸開部分集合とする．
\(\partial{\varOmega}\)上で局所的には，
正則座標変換で\(\varOmega\)を\(\cc^n\)の強凸開集合にうつすもの
が存在する．

\(j\colon\varOmega\hookrightarrow\bar{\varOmega}\)を
うめこみとする．\(\bar{\varOmega}\)上で次の特三角を得る．
\begin{equation}\label{eq:dt-Ox}
    \scO_X\rvert_{\bar{\varOmega}}
    \to 
    \Rder{j}_\ast\scO_\varOmega
    \underset{+1}{\to}
    \RG_{\partial\varOmega}(\scO_X\rvert_{\bar{\varOmega}})
    \to.
\end{equation}
\(
    H^0_{\partial\varOmega}(\scO_X\rvert_{\bar{\varOmega}})=0
\)なので，前層\(
    U\mapsto 
    H^1_{U\cap\partial\varOmega}(
        U\cap\bar{\varOmega};\scO_X\rvert_{\bar{\varOmega}}
    )
\)は層\(
    H^1_{\partial\varOmega}(\scO_X\rvert_{\bar{\varOmega}})
\)と同じである．（Ex II.13）
さらに，\(k>0\)に対し\(\Rder^kj_\ast\scO_\varOmega=0\)なので，
\(k>1\)に対し
\(H^k_{\partial\varOmega}(\scO_X\rvert_{\bar{\varOmega}})=0\)
である．
また，次の\eqref{eq:coh-flb}も成り立つ．
\begin{equation}\label{eq:coh-flb}
    \text{\(
        H^1_{\partial\varOmega}(\scO_X\rvert_{\bar{\varOmega}})
    \)は脆弱層である．}
\end{equation}
\eqref{eq:coh-flb}を証明するために，
命題2.4.10から\(\varOmega\)が強凸であると仮定してよい．
\(U\)を\(\cc^n\)の凸開部分集合とする．
特三角\eqref{eq:dt-Ox}に関手\(\RG(U;\cdot)\)を適用することで，
\[
    \Gamma(
        U\cap\bar{\varOmega};
        H^1_{\partial\varOmega}(
            \scO_X\rvert_{\bar{\varOmega}}
        )
    )\cong
    \scO_X(\varOmega\cap U)/\scO_X(\bar{\varOmega}\cap U)
\]
であることがわかる．
実際，\(U\cap\bar{\varOmega}\)が\(U\)の凸開近傍の基本系をもつことから，
\(k>0\)に対し\(H^k(U\cap\bar{\varOmega};\scO_X)=0\)である．

\(\omega\)を\(\partial\varOmega\)の開部分集合とする．
\(\cc^n\)の凸開部分集合\(U\)で，
\(U\cap\bar{\varOmega}=\omega\)かつ
\(U\cup \varOmega\)が凸となるものが存在する．
このとき，マイヤー・ヴィートリス列
\[
    0\to\scO_X(U\cup\varOmega)
    \to\scO_X(U)\oplus\scO_X(\varOmega)
    \to\scO_X(U\cap\varOmega)\to0
\]
は完全であり，写像
\(
    \scO_X(\varOmega)/\scO_X(\bar{\varOmega})
    \to
    \scO_X(\varOmega\cap U)/\scO_X(\bar{\varOmega}\cap U)
\)
は全射である．以上で\eqref{eq:coh-flb}が示せた．



\subsection{佐藤超関数}\label{ssec:sato}

\(M\)を\(n\)次元実解析多様体とし，\(X\)を\(M\)の複素化とする．
（\(X\)は\(M\)の近傍として一意に定まるのであった．）
佐藤超関数の層\(\scB_M\)を
\begin{equation}
    \scB_M\coloneqq
    H^n_M(\scO_X)\otimes\ori_{M/X}
\end{equation}
で定める．ただし，\(\ori_{M/X}=\ori_{M}\otimes\ori_X\)である．
\eqref{eq:rel-vanish}により，
複体\(\RG_M(\scO_X)[n]\)は次数0に集中しているので，
\[
    \scB_M\cong\RG_M(\scO_X)[n]\otimes \ori_{M/X}
\]が成り立つ．
層\(H^j_M(\scO_X)\)は\(j<n\)で０なので，
（Exercise II.13より）前層\(
    U\mapsto H^j_{U\cap M}(U;\scO_X)
\)は層になり，これは\(\scB_M\)と等しくなる．
（\(\scB_M\)は\(X\)上の層であるが，
これを\(M\)に制限したものと同一視することが多い．）
さらに，\eqref{eq:psudo-convex}より，
\(\scB_M\)が脆弱層であることも従う．
この層は\ref{ssec:dist-hyper}項で述べたものと一致する．
（XI章でさらに詳しく述べる．）


\subsection{局所定数層の例}

\(X=\cc\)とし，\(z\)を\(X\)の正則座標とする．
\(\alpha\)を複素数とし，
\(P\)を正則微分作用素\(
    \displaystyle z\frac{\partial}{\partial{z}}-\alpha
\)とする．
\(X\)上の層の複体
\begin{equation}
    F\coloneq 0\to \scO_X\underset{P}{\to}\scO_X\to0
\end{equation}
を考える．層\(
    H^0(F)\rvert_{X-\{0\}}\cong\Ker(P)\rvert_{X-\{0\}}
\)は局所定数層である．実際，\(X-\{0\}\)の
任意の連結かつ単連結な開集合\(U\)の上で，
\(H^0(F)\rvert_{U}\)は，
\(z^\alpha\)（の分枝）で生成される定数層\(\cc_U\)と同型である．
しかし，\(\alpha\notin\zz\)の場合，
\(X-\{0\}\)上の0でない正則関数\(f\)で\(Pf=0\)をみたすもの
は存在しないので，
\(\Gamma(X-\{0\};H^0(F))=0\)である．
\(\alpha\in\zz\)に対しては以下のようになる．
\begin{quotation}
    %\[\]
    \begin{align*}
        H^0(F)\rvert_{X-\{0\}}\colon\text{階}&\text{数} 1\text{の局所定数層．}\\
        H^0(F)\rvert_{\{0\}}&=0,\\
        H^1(F)&=0.
    \end{align*}
    \(\alpha=0,1,2,\dots\)のとき，
    \begin{align*}
        H^0(F)&\cong\cc_X,\\
        H^1(F)&=\cc_{\{0\}}.
    \end{align*}
    \(\alpha=-1,-2,\dots\)のとき，
    \begin{align*}
        H^0(F)&\cong\cc_{X-\{0\}},\\
        H^1(F)&=0.
    \end{align*}
\end{quotation}
複体\(F\)は「偏屈層」と呼ばれるものの簡単な例になっている．
このような複体についてはVIII章とX章で調べる．

\chapter{Poincar\'e-Verdier 双対性}

\section{上付きびっくり}
\subparagraph{\cite[V, 6.1]{B+84}}
\(A\)に対し，全射\(P\to{A}\)で，\(P\)が零で延長した層\(R_U\)の直和であるものが存在する．
\begin{LMM}\cite[{V. Proposition 6.5}]{B+84}
    \(S,A\in\Sh(X)\)とする．
    \(S\)がc柔軟であり，\(S,A\)のどちらかは平坦であるとする．
    このとき，\(A\otimes S\)はc柔軟である．
\end{LMM}
\begin{proof}
    完全列\begin{equation}\label{eq:flat-soft}
        0\to{P_{n}}\to{P_{n-1}}\to\dots\to{P_{0}}\to{A}\to0
    \end{equation}
    で\(0\leqq{j}\leqq{n-1}\)に対し，
    \({P_{j}}\)が層\(R_U\)の直和となり，
    したがって平坦となるものがある．
    系列
    \begin{equation}
        0\to{P_{n}}\otimes{S}\to{P_{n-1}}\otimes{S}
        \to\dots\to{P_{0}}\otimes{S}\to{A}\otimes{S}\to0
    \end{equation}
    についても，\(S\)が平坦であることから，
    あるいは，\(A\)が平坦であれば
    系列\eqref{eq:flat-soft}の各項が平坦となることから完全になる．

\end{proof}

\begin{LMM}\cite[{VI. Th\'eor\`eme 3.5}]{B+84}
    \(G\)が\(\Komp^+(Y)\)の対象ならば，
    \(f^!_K(G)\)は\(\Komp^+(X)\)の対象である．
\end{LMM}
\begin{proof}
    \((U_\alpha)_{\alpha\in{\Lambda}}\)を\(X\)の開集合族とする．
    \(U=\bigcup_{\alpha\in\Lambda}U_\alpha\)，
    \(U_{\alpha\beta}=U_\alpha\cap U_\beta\)とおき，系列
    \[
        0\to f^!_K(G)(U)
        \overset{\varphi}{\longrightarrow}
        \prod_{\alpha\in\Lambda}^{}f^!_K(G)(U_\alpha)
        \overset{\psi}{\longrightarrow}
        \prod_{(\alpha,\beta)\in\Lambda\times\Lambda}f^!_K(G)(U_{\alpha\beta})
    \]
    を考える．
    ここに，\begin{align*}
        \varphi(s)&=\left(\rho_{U_\alpha,U}(s)\right)_{\alpha\in\Lambda},\\
        \psi\left(\left(s_\alpha\right)_{\alpha\in\Lambda}\right)
        &=\left(
            \rho_{U_{\alpha\beta},U_{\alpha}}\left(s_\alpha\right)
            -
            \rho_{U_{\alpha\beta},U_{\beta}}\left(s_\beta\right)
        \right)_{(\alpha,\beta)\in\Lambda\times\Lambda}
    \end{align*}である．
    この系列が完全であることを示す．

\end{proof}


\subsection{構成}

\(X\), \(Y\)を局所コンパクト空間とし，
\(f\colon{Y}\to{X}\)を連続写像とする．
\(A\)を大域次元が有限な可換環とする．
\(F\in\Domp^+(A_X)\), \(G\in\Domp^+(A_Y)\)とする．

\(\Rder{f_!}\colon\Domp^+(A_Y)\to\Domp^+(A_X)\)の右随伴関手
\(f^!\colon\Domp^+(A_X)\to\Domp^+(A_Y)\)を構成する．
まず，開集合\(V\subset Y\)に対し，\(f^!{F}\)の\(V\)上の切断
に関する条件を見てみる．
\[
    \RG(V;f^!{F})
    =\Rder\Hom_{A_Y}(A_V,f^!F)
    =\Rder\Hom_{A_X}(\Rder{f_!}A_V,F)
\]
となることから，\(f^!F\)は
\(V\mapsto\Rder\Hom_{A_X}(\Rder{f_!}A_V,F)\)
という対応でなければならない．
\(\Rder{f_!}\)を計算するにはc柔軟分解
\(A_V\sim K\)を
取ればよく，さらに\(F\)が入射的であれば，
\[
    \Rder\Hom_{A_X}(\Rder{f_!}A_V,F)
    =\Hom_{A_X}({f_!}K_V,F)
\]
となって，結局
\[
    \RG(V;f^!{F})
    =\Hom_{A_X}({f_!}K_V,F)
\]
とできる．

\paragraph{\(f\)に関する仮定}
\begin{DFN}
    \(Y\)上の層\(G\)が\(f\)柔軟であるとは，各点\(x\in{X}\)に対し，
    \(G\rvert_{f^{-1}(x)}\)がc柔軟であることをいう．
\end{DFN}
\(G\)が\(f\)柔軟であることと，
任意の開部分集合\(V\subset{Y}\)と\(j\ne0\)に対し，
\(\Rder^jf_!G_V=0\)となることと同値である．

次を仮定する．
\begin{equation}\label{eq:fdim}
    f_!\colon\Mod(\zz_Y)\to\Mod(\zz_X)\text{のコホモロジー次元は有限である．}
\end{equation}
つまり，整数\(r\geqq0\)で，全ての\(j>r\)に対し\(\Rder^jf_!=0\)となるものが存在する．
\eqref{eq:fdim}は次の条件と同値である．
\begin{equation}\label{eq:fdim1}
\begin{cases}
    \text{任意の}G\in\Sh(Y)\text{に対し，完全列}\\
    0\to{G}\to{G^0}\to\dots\to{G^r}\to0\\
    \text{で，どの}G^j\text{も\(f\)柔軟であるものが存在する．}
\end{cases}    
\end{equation}
\begin{equation}\label{eq:fdim2}\tag{3.1.4\('\)}
\begin{cases}
    \text{完全列}
    {G^0}\to\dots\to{G^r}\to0\\
    \text{において，\(j<r\)に対し\(G^j\)が\(f\)柔軟ならば，}\\
    \text{\(G^r\)が\(f\)柔軟となる．}
\end{cases}
\end{equation}
\(f_!\)のコホモロジー次元が\(\leqq{r}\)となるのは，
任意の\(x\in{X}\)に対し，
\(\Gamma_c(f^{-1}(x);\cdot)\)の
コホモロジー次元が\(\leqq{r}\)となるときである．
実際，\(f_!\rvert_{f^{-1}(x)}F=\Gamma_c(f^{-1}(x);F)=0\)となるので．

\paragraph{構成}
以上の仮定は，
\[
    \RG(V;f^!{F})
    =\Hom_{A_X}({f_!}K_V,F)
\]
の構成をするためだった．
\(f_!K_V\)の分解をしたくて，
その長さが有限になるという仮定である．

さて，\(K\)を\(\zz_Y\)加群，\(F\)を\(A_X\)加群とする．
このとき，\(A\)加群の前層\(f^!_KF\)を次で定める．
\(V\in\Op(Y)\)に対し，
\[
    (f^!_KF)(V)
    \coloneqq
    \Hom_{A_X}\left(f_!\left(
        A_Y\mathop{\otimes}\limits_{\zz_Y}K_V
    \right),F\right)
\]
とする．
制限射は\(K_{V'}\to{K_V}\)から引き起こされるもの．

\begin{LMM}
    \(K\)を平坦かつ\(f\)柔軟な\(\zz_Y\)加群とする．
    \begin{enumerate}[(i)]
        \item \(Y\)上の任意の層\(G\)に対し\(G\otimes_{\zz_Y}K\)は\(f\)柔軟である．
        \item \(G\mapsto f_!(G\otimes_{\zz_Y}K)\)は
        \(\Mod(\zz_Y)\)から\(\Mod(\zz_X)\)への完全関手である．
    \end{enumerate}
\end{LMM}
\begin{proof}
    (i) 
    \(Y\)上の任意の層\(G\)は分解
    \[
        \to{G^{-r}}\to\dots\to{G^{0}}\to{G}\to0
    \]
    で，各\(G^{j}\)が\(\zz_V\)の直和となるものが存在する．
\end{proof}









%\backmatter
%\appendix
%\chapter{aa}
%===============================================
% 参考文献スペース
%===============================================
\begin{thebibliography}{20} 
    \bibitem[B+84]{B+84} Borel, 
        \textit{Intersection Cohomology}, 
        Progress in Mathematics, 50, Birkh\"auser, 1984.
    \bibitem[G58]{G58} Grauert, 
        \textit{On Levi's problem and the embedding of real analytic manifolds}, 
        Ann. Math. 68, 460--472 (1958).
    \bibitem[GP74]{GP74} Victor Guillemin, Alan Pollack, 
        \textit{Differential Topology}, 
        Prentice-Hall, 1974.
    \bibitem[KS90]{KS90} Masaki Kashiwara, Pierre Schapira, 
        \textit{Sheaves on Manifolds}, 
        Grundlehren der Mathematischen Wissenschaften, 292, Springer, 1990.
    \bibitem[KS06]{KS06} Masaki Kashiwara, Pierre Schapira, 
        \textit{Categories and Sheaves}, 
        Grundlehren der Mathematischen Wissenschaften, 332, Springer, 2006.
    \bibitem[R55]{R55} de Rham, 
        \textit{Vari\'et\'es diff\'erentiables}, 
        Hermann, Paris, 1955.
    \bibitem[Sa59]{Sa59} Mikio Sato, 
        \textit{Theory of Hyperfunctions}, 
        1959--60.
    \bibitem[S66]{S66} Schwartz, 
        \textit{Th\'eorie de distributions}, 
        Hermann, Paris, 1966.
    \bibitem[Sh16]{Sh16} 志甫淳, 層とホモロジー代数, 共立出版, 2016.
    \bibitem[Ike21]{Ike21} 池祐一, 超局所層理論概説, 2021.
    \bibitem[Tak17]{Tak17} 竹内潔, \(\D\)加群, 共立出版, 2017.
    %\bibitem[Og02]{Og02} 小木曽啓示, 代数曲線論, 朝倉書店, 2022.
\end{thebibliography}

%===============================================


\end{document}
