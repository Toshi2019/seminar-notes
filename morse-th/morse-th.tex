
%Don't forget to delete
%showkeys
%overfullrule
%\date \ber \er \cmt

%------------------------
\documentclass[11pt, a4paper, dvipdfmx]{jsarticle}


%usepackage
%------------------------
\usepackage{amsmath}
\usepackage{amsthm}
%\usepackage[psamsfonts]{amssymb}
\usepackage{color}
\usepackage{ascmac}
\usepackage{amsfonts}
\usepackage{mathrsfs}
\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{fancybox}
%\usepackage{enumerate}
\usepackage{enumitem}
\usepackage{verbatim}
\usepackage{subfigure}
\usepackage{proof}
\usepackage{listings}
\usepackage{otf}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{tikz}
\usepackage[all]{xy}
\usepackage{amscd}

\usepackage{pb-diagram}

\usepackage[dvipdfmx]{hyperref}
\usepackage{xcolor}
\definecolor{darkgreen}{rgb}{0,0.45,0} 
\definecolor{darkred}{rgb}{0.75,0,0}
\definecolor{darkblue}{rgb}{0,0,0.6} 
\hypersetup{
    colorlinks=true,
    citecolor=darkgreen,
    linkcolor=darkred,
    urlcolor=darkblue,
}
\usepackage{pxjahyper}

\usepackage{enumitem}

\usepackage{bbm}

% ================================
% パッケージを追加する場合のスペース 
\usepackage{latexsym}
\usepackage{wrapfig}
\usepackage{layout}
\usepackage{url}

\usepackage{okumacro}
%=================================


% --------------------------
% theoremstyle
% --------------------------
\theoremstyle{definition}


% --------------------------
% newtheoem
% --------------------------

% 日本語で定理, 命題, 証明などを番号付きで用いるためのコマンドです. 
% If you want to use theorem environment in Japanece, 
% you can use these code. 
% Attention!
% All theorem enivironment numbers depend on 
% only section numbers.
\newtheorem{Axiom}{公理}[section]
\newtheorem{Definition}[Axiom]{定義}
\newtheorem{Theorem}[Axiom]{定理}
\newtheorem{Proposition}[Axiom]{命題}
\newtheorem{Lemma}[Axiom]{補題}
\newtheorem{Corollary}[Axiom]{系}
\newtheorem{Example}[Axiom]{例}
\newtheorem{Claim}[Axiom]{主張}
\newtheorem{Property}[Axiom]{性質}
\newtheorem{Attention}[Axiom]{注意}
\newtheorem{Question}[Axiom]{問}
\newtheorem{Problem}[Axiom]{問題}
\newtheorem{Consideration}[Axiom]{考察}
\newtheorem{Alert}[Axiom]{警告}
\newtheorem{Fact}[Axiom]{事実}


% 日本語で定理, 命題, 証明などを番号なしで用いるためのコマンドです. 
% If you want to use theorem environment with no number in Japanese, You can use these code.
\newtheorem*{Axiom*}{公理}
\newtheorem*{Definition*}{定義}
\newtheorem*{Theorem*}{定理}
\newtheorem*{Proposition*}{命題}
\newtheorem*{Lemma*}{補題}
\newtheorem*{Example*}{例}
\newtheorem*{Corollary*}{系}
\newtheorem*{Claim*}{主張}
\newtheorem*{Property*}{性質}
\newtheorem*{Attention*}{注意}
\newtheorem*{Question*}{問}
\newtheorem*{Problem*}{問題}
\newtheorem*{Consideration*}{考察}
\newtheorem*{Alert*}{警告}
\newtheorem{Fact*}{事実}


% 英語で定理, 命題, 証明などを番号付きで用いるためのコマンドです. 
%　If you want to use theorem environment in English, You can use these code.
%all theorem enivironment number depend on only section number.
\newtheorem{Axiom+}{Axiom}[section]
\newtheorem{Definition+}[Axiom+]{Definition}
\newtheorem{Theorem+}[Axiom+]{Theorem}
\newtheorem{Proposition+}[Axiom+]{Proposition}
\newtheorem{Lemma+}[Axiom+]{Lemma}
\newtheorem{Example+}[Axiom+]{Example}
\newtheorem{Corollary+}[Axiom+]{Corollary}
\newtheorem{Claim+}[Axiom+]{Claim}
\newtheorem{Property+}[Axiom+]{Property}
\newtheorem{Attention+}[Axiom+]{Attention}
\newtheorem{Question+}[Axiom+]{Question}
\newtheorem{Problem+}[Axiom+]{Problem}
\newtheorem{Consideration+}[Axiom+]{Consideration}
\newtheorem{Alert+}{Alert}
\newtheorem{Fact+}[Axiom+]{Fact}
\newtheorem{Remark+}[Axiom+]{Remark}

% ----------------------------
% commmand
% ----------------------------
% 執筆に便利なコマンド集です. 
% コマンドを追加する場合は下のスペースへ. 

% 集合の記号 (黒板文字)
\newcommand{\NN}{\mathbb{N}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\QQ}{\mathbb{Q}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\CC}{\mathbb{C}}
\newcommand{\PP}{\mathbb{P}}
\newcommand{\KK}{\mathbb{K}}


% 集合の記号 (太文字)
\newcommand{\nn}{\mathbf{N}}
\newcommand{\zz}{\mathbf{Z}}
\newcommand{\qq}{\mathbf{Q}}
\newcommand{\rr}{\mathbf{R}}
\newcommand{\cc}{\mathbf{C}}
\newcommand{\pp}{\mathbf{P}}
\newcommand{\kk}{\mathbf{K}}

% 特殊な写像の記号
\newcommand{\ev}{\mathop{\mathrm{ev}}\nolimits} % 値写像
\newcommand{\pr}{\mathop{\mathrm{pr}}\nolimits} % 射影

% スクリプト体にするコマンド
%   例えば　{\mcal C} のように用いる
\newcommand{\mcal}{\mathcal}

% 花文字にするコマンド 
%   例えば　{\h C} のように用いる
\newcommand{\h}{\mathscr}

% ヒルベルト空間などの記号
\newcommand{\F}{\mcal{F}}
\newcommand{\X}{\mcal{X}}
\newcommand{\Y}{\mcal{Y}}
\newcommand{\HH}{\mcal{H}}
\newcommand{\RKHS}{\Hil_{k}}
\newcommand{\Loss}{\mcal{L}_{D}}
\newcommand{\MLsp}{(\X, \Y, D, \Hil, \Loss)}

% 偏微分作用素の記号
\newcommand{\p}{\partial}

% 角カッコの記号 (内積は下にマクロがあります)
\newcommand{\lan}{\langle}
\newcommand{\ran}{\rangle}



% 圏の記号など
\newcommand{\Set}{{\bf Set}}
\newcommand{\Vect}{{\bf Vect}}
\newcommand{\FDVect}{{\bf FDVect}}
\newcommand{\Ring}{{\bf Ring}}
\newcommand{\Ab}{{\bf Ab}}
\newcommand{\Mod}{\mathop{\mathrm{Mod}}\nolimits}
\newcommand{\CGA}{{\bf CGA}}
\newcommand{\GVect}{{\bf GVect}}
\newcommand{\Lie}{{\bf Lie}}
\newcommand{\dLie}{{\bf Liec}}



% 射の集合など
\newcommand{\Map}{\mathop{\mathrm{Map}}\nolimits}
\newcommand{\Hom}{\mathop{\mathrm{Hom}}\nolimits}
\newcommand{\End}{\mathop{\mathrm{End}}\nolimits}
\newcommand{\Aut}{\mathop{\mathrm{Aut}}\nolimits}
\newcommand{\Mor}{\mathop{\mathrm{Mor}}\nolimits}

% その他便利なコマンド
\newcommand{\dip}{\displaystyle} % 本文中で数式モード
\newcommand{\e}{\varepsilon} % イプシロン
\newcommand{\dl}{\delta} % デルタ
\newcommand{\pphi}{\varphi} % ファイ
\newcommand{\ti}{\tilde} % チルダ
\newcommand{\pal}{\parallel} % 平行
\newcommand{\op}{{\rm op}} % 双対を取る記号
\newcommand{\lcm}{\mathop{\mathrm{lcm}}\nolimits} % 最小公倍数の記号
\newcommand{\Probsp}{(\Omega, \F, \P)} 
\newcommand{\argmax}{\mathop{\rm arg~max}\limits}
\newcommand{\argmin}{\mathop{\rm arg~min}\limits}





% ================================
% コマンドを追加する場合のスペース 
\newcommand{\UU}{\mcal{U}}
\newcommand{\OO}{\mcal{O}}
\newcommand{\emp}{\varnothing}
\newcommand{\ceq}{\coloneqq}
\newcommand{\sbs}{\subset}
\newcommand{\mapres}[2]{\left. #1 \right|_{#2}}
\newcommand{\ded}{\hfill $\blacksquare$}
\newcommand{\id}{\mathrm{id}}
\newcommand{\isom}{\overset{\sim}{\longrightarrow}}
\newcommand{\tTop}{\textsf{Top}}


% 自前の定理環境
%   https://mathlandscape.com/latex-amsthm/
% を参考にした
\newtheoremstyle{mystyle}%   % スタイル名
    {5pt}%                   % 上部スペース
    {5pt}%                   % 下部スペース
    {}%              % 本文フォント
    {}%                  % 1行目のインデント量
    {\bfseries}%                      % 見出しフォント
    {.}%                     % 見出し後の句読点
    {12pt}%                     % 見出し後のスペース
    {\thmname{#1}\thmnumber{ #2 }\thmnote{{\normalfont (#3)}}}% % 見出しの書式

\theoremstyle{mystyle}
\newtheorem{AXM}{公理}[section]
\newtheorem{DFN}[Axiom]{定義}
\newtheorem{THM}[Axiom]{定理}
\newtheorem*{THM*}{定理}
\newtheorem{PRP}[Axiom]{命題}
\newtheorem{LMM}[Axiom]{補題}
\newtheorem{CRL}[Axiom]{系}
\newtheorem{EG}[Axiom]{例}

%\newtheorem{}{Axiom}[]
\numberwithin{equation}{section} % 式番号を「(3.5)」のように印刷

\newcommand{\MM}{\mcal{M}}

% =================================


% ---------------------------
% new definition macro
% ---------------------------
% 便利なマクロ集です

% 内積のマクロ
%   例えば \inner<\pphi | \psi> のように用いる
\def\inner<#1>{\langle #1 \rangle}

% ================================
% マクロを追加する場合のスペース 

%=================================





% ----------------------------
% documenet 
% ----------------------------
% 以下, 本文の執筆スペースです. 
% Your main code must be written between 
% begin document and end document.
% ---------------------------



\begin{document}

\title{Morse理論}
\author{Toshi2019}

%\date{December 13, 2021}

\maketitle
\begin{abstract}
2022年度秋セメスターで行うMorse理論ゼミのための勉強ノート．
実質\cite{M01}の読書ノート．
\end{abstract}

%\tableofcontents
\section*{はじめに}
個人的なモチベはシンプレクティック幾何と層の超局所理論に由来する．
前者に関して，どうやらMorse理論は
シンプレクティック幾何の原型になっている\footnote{
    シンプレクティック幾何の中でも，
    とくにFloer理論というものの原型らしく，
    無限次元のMorse理論をやることに
    対応しているとかいないとか．(\cite{Ono06}参照)
}らしいので，
本格的に勉強する前に，Morse理論をかじっておこうというモチベ．
後者に関して，層の超局所理論は層理論における
Morse理論という見方ができるらしい\cite{Ike21}.
そういった幾何的な見方がわかるようになりたいというのも一つのモチベ．
なので低次元トポロジーにはそこまで興味があるわけではない．

\section*{凡例}
\begin{itemize}
    \item 関数：断りがなければ関数は実数値の写像とする．
    \item 偏微分作用素：$\p/{\p x}$を$\p_x$で表すことがある．
\end{itemize}

\section{曲面上のMorse理論}

\subsection{関数の臨界点}

%以下，関数はすべて滑らか（$C^{\infty}$級）であるとする．
$u<v$を実数とし，$y=f(x)$を開区間$(u,v)$で定義された$C^{\infty}$級関数
とする．$(u,v)$の点$a$が$y=f(x)$の臨界点であるとは，
\begin{align}
    f'(a)=0 \label{eq:1}
\end{align}
であることをいう．

$u<v$を実数とし，
$y=f(x)$を開区間$(u,v)$で定義された$C^{\infty}$級関数とし，
$(u,v)$の点$a$を$y=f(x)$の臨界点とする．
このとき，$x=a$が$y=f(x)$の\textbf{退化した臨界点} (degenerate critical point) とは
\begin{align}
    f''(a)=0
\end{align}
であることをいう．
$x=a$が退化していないとき，\textbf{非退化な臨界点} (nondegenerate critical point) であるという．


\begin{Example}
    1.
    $y=f(x)=x^2$とおく．
    $f'(x)=2x$なので，$f'(0)=0$である．
    $f''(x)=2$なので，$f''(0)\neq0$である．
    よって$x=0$は$y=x^2$の非退化な臨界点である．

    2.
    自然数$n\geqq 3$に対し$y=f(x)=x^n$とおく．
    $f'(x)=nx^{n-1}$なので，$f'(0)=0$である．
    $f''(x)=n(n-1)x^{n-2}$なので，$f''(0)=0$である．
    したがって$x=0$は$y=x^n$の退化した臨界点である．
\end{Example}


\subsection{Hesse行列}

\begin{DFN}
    $U$を平面$\rr^2$の開集合とする．
    $z=f(x,y)$を$U$で定義された$C^{\infty}$級関数とする．
    $U$の点$p_0=(x_0,y_0)$が$z=f(x,y)$の臨界点であるとは
    \begin{align}
        f'(p_0)=\left(\frac{\p f}{\p x}(p_0)\quad \frac{\p f}{\p y}(p_0)\right)=(0,0) \label{eq:crit2}
    \end{align}
    が成り立つことをいう．
\end{DFN}

\begin{EG}
    平面の原点$0=(0,0)$は
    \begin{align}
        z=f(x,y)=x^2+y^2,&& z=g(x,y)=x^2-y^2,&& z=h(x,y)=-x^2-y^2 \label{eq:quadFunc}
    \end{align}
    の臨界点である．実際
    \begin{align*}
        f'(0,0) &= \Big(f'_x(0,0)\quad f'_y(0,0)\Big)=(2x,2y)|_{(x,y)=(0,0)}=(0,0),  \\
        g'(0,0) &= \Big(g'_x(0,0)\quad g'_y(0,0)\Big)=(2x,-2y)|_{(x,y)=(0,0)}=(0,0),  \\
        h'(0,0) &= \Big(h'_x(0,0)\quad h'_y(0,0)\Big)=(-2x,-2y)|_{(x,y)=(0,0)}=(0,0)
%        &\p_xg(x,y)=2x, \quad \p_yg(x,y)=-2y, \\
%        &\p_xh(x,y)=-2x,\quad \p_yh(x,y)=-2y 
    \end{align*}
    となるので原点はこれらの臨界点である．
\end{EG}

\begin{DFN}
    $(x,y)=p_0$を$f$の臨界点とする．
    $f$のヘッセ行列
    \begin{align}
        H_f(p_0)=
        \begin{bmatrix*}
            \dip \frac{\p^2 f}{\p x^2}(p_0)   &\dip\frac{\p^2 f}{\p x\p y}(p_0)\\\\
            \dip \frac{\p^2 f}{\p y\p x}(p_0) &\dip \frac{\p^2 f}{\p y^2}(p_0)\\
        \end{bmatrix*}
    \end{align}
    の行列式（ヘッシアン）
    \begin{align}
        \det H_f(p_0) = \frac{\p^2 f}{\p x^2}(p_0)\dip \frac{\p^2 f}{\p y^2}(p_0)
        -\left(\frac{\p^2 f}{\p x\p y}(p_0)\right)^2 \label{eq:hessian}
    \end{align}
    が0のとき，$p_0$は退化しているという．
    そうでないとき，$p_0$は非退化な臨界点という．
\end{DFN}

\begin{EG}
    式\eqref{eq:quadFunc}の関数たちのHesse行列は
    \begin{align*}
        H_f(0)&=
        \begin{bmatrix*}
            \dip 2&0\\
            \dip 0&2
        \end{bmatrix*},\\
        H_g(0)&=
        \begin{bmatrix*}
            \dip 2 & 0\\
            \dip 0 &-2
        \end{bmatrix*},\\
        H_h(0)&=
        \begin{bmatrix*}
            \dip -2& 0\\
            \dip 0 &-2
        \end{bmatrix*}
    \end{align*}
    である．これらの行列式は0でないので，原点は非退化な臨界点である．
\end{EG}

\begin{EG}\label{eg:n-deg}
    関数$z=xy$は原点を臨界点にもつ．
    Hesse行列は
    \begin{align*}
        H(0)=\begin{bmatrix*}
            0&1\\
            1&0
        \end{bmatrix*}
    \end{align*}
    で$\det H(0)=-1\neq0$なので0は非退化な臨界点である．
\end{EG}

\begin{EG}
    関数$z=x^2+y^3$は原点を退化した臨界点としてもつ．
\end{EG}

\begin{LMM}
    平面の点$p_0$を関数$z=f(x,y)$の臨界点とする．
    座標$(x,y)$におけるHesse行列を$H_f(p_0)$, 座標$(X,Y)$に
    おけるHesse行列を$\HH_f(p_0)$とする．このとき次が成り立つ．
    \begin{align}
        \HH_f(p_0)={}^t\!J(p_0)H_f(p_0)J(p_0).
    \end{align}
    ただし$J(p_0)$はJacobi行列
    \begin{align}
        J(p_0)=
        \begin{bmatrix*}
            \dip \frac{\p x}{\p X}(p_0)   &\dip\frac{\p x}{\p Y}(p_0)\\\\
            \dip \frac{\p y}{\p X}(p_0) &\dip \frac{\p y}{\p Y}(p_0)\\
        \end{bmatrix*}
        \label{eq:jacbiMet}
    \end{align}
    である．
\end{LMM}

\begin{proof}[\textbf{証明}]
    \begin{align*}
        \frac{\p^2 f}{\p X^2} 
        =\frac{\p}{\p X}\frac{\p f}{\p X}
        &=\frac{\p}{\p X}\left(
            \frac{\p f}{\p x}\frac{\p x}{\p X} 
            +\frac{\p f}{\p y}\frac{\p y}{\p X}
        \right)\\
        &=\left(
            \frac{\p}{\p X}\frac{\p f}{\p x}
        \right)\frac{\p x}{\p X}
        +\left(
            \frac{\p}{\p X}\frac{\p f}{\p y}
        \right)\frac{\p y}{\p X}\\
        &=\left(
            \frac{\p^2 f}{\p x^2}\frac{\p x}{\p X}
            +\frac{\p^2 f}{\p y\p x}\frac{\p y}{\p X}
        \right)\frac{\p x}{\p X}
        +\left(
            \frac{\p^2 f}{\p x\p y}\frac{\p x}{\p X}
            +\frac{\p^2 f}{\p y^2}\frac{\p y}{\p X}
        \right)\frac{\p y}{\p X},
        %
    \end{align*}
    \begin{align*}
        %
        \frac{\p^2 f}{\p X\p Y} 
        =\frac{\p}{\p X}\frac{\p f}{\p Y}
        &=\frac{\p}{\p X}\left(
            \frac{\p f}{\p x}\frac{\p x}{\p Y} 
            +\frac{\p f}{\p y}\frac{\p y}{\p Y}
        \right)\\
        &=\left(
            \frac{\p}{\p X}\frac{\p f}{\p x}
        \right)\frac{\p x}{\p Y}
        +\left(
            \frac{\p}{\p X}\frac{\p f}{\p y}
        \right)\frac{\p y}{\p Y}\\
        &=\left(
            \frac{\p^2 f}{\p x^2}\frac{\p x}{\p X}
            +\frac{\p^2 f}{\p y\p x}\frac{\p y}{\p X}
        \right)\frac{\p x}{\p Y}
        +\left(
            \frac{\p^2 f}{\p x\p y}\frac{\p x}{\p X}
            +\frac{\p^2 f}{\p y^2}\frac{\p y}{\p X}
        \right)\frac{\p y}{\p Y},\\
        %
        %
        \frac{\p^2 f}{\p Y\p X} 
        =\frac{\p}{\p Y}\frac{\p f}{\p X}
        &=\frac{\p}{\p Y}\left(
            \frac{\p f}{\p x}\frac{\p x}{\p X} 
            +\frac{\p f}{\p y}\frac{\p y}{\p X}
        \right)\\
        &=\left(
            \frac{\p}{\p Y}\frac{\p f}{\p x}
        \right)\frac{\p x}{\p X}
        +\left(
            \frac{\p}{\p Y}\frac{\p f}{\p y}
        \right)\frac{\p y}{\p X}\\
        &=\left(
            \frac{\p^2 f}{\p x^2}\frac{\p x}{\p Y}
            +\frac{\p^2 f}{\p y\p x}\frac{\p y}{\p Y}
        \right)\frac{\p x}{\p X}
        +\left(
            \frac{\p^2 f}{\p x\p y}\frac{\p x}{\p Y}
            +\frac{\p^2 f}{\p y^2}\frac{\p y}{\p Y}
        \right)\frac{\p y}{\p X},\\
        %
        %
        \frac{\p^2 f}{\p Y^2} 
        =\frac{\p}{\p Y}\frac{\p f}{\p Y}
        &=\frac{\p}{\p Y}\left(
            \frac{\p f}{\p x}\frac{\p x}{\p Y} 
            +\frac{\p f}{\p y}\frac{\p y}{\p Y}
        \right)\\
        &=\left(
            \frac{\p}{\p Y}\frac{\p f}{\p x}
        \right)\frac{\p x}{\p Y}
        +\left(
            \frac{\p}{\p Y}\frac{\p f}{\p y}
        \right)\frac{\p y}{\p Y}\\
        &=\left(
            \frac{\p^2 f}{\p x^2}\frac{\p x}{\p Y}
            +\frac{\p^2 f}{\p y\p x}\frac{\p y}{\p Y}
        \right)\frac{\p x}{\p Y}
        +\left(
            \frac{\p^2 f}{\p x\p y}\frac{\p x}{\p Y}
            +\frac{\p^2 f}{\p y^2}\frac{\p y}{\p Y}
        \right)\frac{\p y}{\p Y}
    \end{align*}
    だから
    \begin{align*}
        \HH_f(p_0)
        &=\begin{bmatrix*}
            \dip \frac{\p^2 f}{\p X^2} &\dip \frac{\p^2 f}{\p X\p Y}\\\\
            \dip \frac{\p^2 f}{\p Y\p X} &\dip \frac{\p^2 f}{\p Y^2}
        \end{bmatrix*}\\
        &=\begin{bmatrix*}
            \dip \frac{\p^2 f}{\p x^2}\frac{\p x}{\p X}
                +\frac{\p^2 f}{\p y\p x}\frac{\p y}{\p X}&
            \dip \frac{\p^2 f}{\p x\p y}\frac{\p x}{\p X}
                +\frac{\p^2 f}{\p y^2}\frac{\p y}{\p X}\\\\
            \dip \frac{\p^2 f}{\p x^2}\frac{\p x}{\p Y}
                +\frac{\p^2 f}{\p y\p x}\frac{\p y}{\p Y}&
            \dip \frac{\p^2 f}{\p x\p y}\frac{\p x}{\p Y}
                +\frac{\p^2 f}{\p y^2}\frac{\p y}{\p Y}
        \end{bmatrix*}\begin{bmatrix*}
            \dip \frac{\p x}{\p X} &\dip \frac{\p x}{\p Y}\\\\
            \dip \frac{\p y}{\p X} &\dip \frac{\p y}{\p Y}
        \end{bmatrix*}\\
        &=\begin{bmatrix*}
            \dip \frac{\p x}{\p X} &\dip \frac{\p y}{\p X}\\\\
            \dip \frac{\p x}{\p Y} &\dip \frac{\p y}{\p Y}
        \end{bmatrix*}\begin{bmatrix*}
            \dip \frac{\p^2 f}{\p x^2} &\dip \frac{\p^2 f}{\p x\p y}\\\\
            \dip \frac{\p^2 f}{\p y\p x} &\dip \frac{\p^2 f}{\p y^2}
        \end{bmatrix*}\begin{bmatrix*}
            \dip \frac{\p x}{\p X} &\dip \frac{\p x}{\p Y}\\\\
            \dip \frac{\p y}{\p X} &\dip \frac{\p y}{\p Y}
        \end{bmatrix*}\\
        &={}^t\!J(p_0)H_f(p_0)J(p_0)
    \end{align*}
    が成り立つ．
\end{proof}

\begin{EG}
    例\ref{eg:n-deg}の関数$z=xy$は座標変換
    \begin{align}
        \begin{cases}
            x=X-Y\\
            y=X+Y
        \end{cases}\label{eq:cord-tr}
    \end{align}
    によって
    \begin{align*}
        xy=(X-Y)(X+Y)=X^2-Y^2
    \end{align*}
    と書き直される．
    これは式\eqref{eq:quadFunc}の$g(x,y)$と同じ関数である．
    $xy$と$X^2-Y^2$の原点0におけるHesse行列は
    \begin{align*}
        \begin{bmatrix*}
            0&1\\1&0
        \end{bmatrix*},
        \begin{bmatrix*}
            2&0\\0&-2
        \end{bmatrix*}
    \end{align*}
    である．座標変換\eqref{eq:cord-tr}のJacobi行列は
    \begin{align*}
        \begin{bmatrix*}
            1&-1\\1&1
        \end{bmatrix*}
    \end{align*}
    なので
    \begin{align*}
        \prescript{t\!}{}{\begin{bmatrix*}
            1&-1\\1&1
        \end{bmatrix*}}\begin{bmatrix*}
            0&1\\1&0
        \end{bmatrix*}\begin{bmatrix*}
            1&-1\\1&1
        \end{bmatrix*}
        =\begin{bmatrix*}
            1&1\\1&-1
        \end{bmatrix*}\begin{bmatrix*}
            1&-1\\1&1
        \end{bmatrix*}
        =\begin{bmatrix*}
            2&0\\0&-2
        \end{bmatrix*}
    \end{align*}
    が成り立つ．
\end{EG}

\begin{CRL}
    平面の点$p_0$が関数$f$の非退化な臨界点であることは
    座標系の取り方によらない．
\end{CRL}

\subsection{Morseの補題}

\begin{THM}[Morseの補題]
    平面の点$p_0$が2変数関数$f$の非退化な臨界点であるとき，
    $p_0$の周りの局所座標系$(X,Y)$をうまく選んで，
    その局所座標系によって表した関数$f$の形が，
    次の3つの標準形のどれかになるようにできる．
    \begin{enumerate}[label=(\roman*)]
        \item $f=X^2+Y^2+c$,
        \item $f=X^2-Y^2+c$,
        \item $f=-X^2-Y^2+c$.
    \end{enumerate}
    ここに，$c$は定数$(=f(p_0))$である．
    また，$p_0$は$(X,Y)$の原点になっている$(p_0=(0,0))$.
\end{THM}

\begin{CRL}
    2変数関数$f$の非退化な臨界点は孤立した臨界点である．
    （つまり，
    \begin{align*}
        C_f\coloneqq\{f\text{の臨界点}\}
    \end{align*}
    は平面の離散集合である．）
\end{CRL}

\begin{DFN}[非退化な臨界点の指数]
    点$p_0$を2変数$f$の非退化な臨界点とする．
    点$p_0$の近傍で適当な局所座標系$(x,y)$により$f$を標準形で表したとき，
    標準形に現れる符号の数を$p_0$の指数という．
\end{DFN}

%指数のwell-definedness：対角化と慣性律

\subsection{曲面上のMorse関数}

%閉曲面
%種数
%S^2, T^2
%\Sigma_g

$p_0$を曲面$M$の点とする．
$p_0$が曲面$M$上の関数$f\colon M\to\rr$臨界点であるとは
$p_0$の局所座標系で
\begin{align}
    \frac{\p f}{\p x}(p_0)=0,\quad 
    \frac{\p f}{\p y}(p_0)=0
\end{align}
が成り立つことをいう．

\begin{DFN}[Morse関数]
    曲面$M$上の関数$f\colon M\to \rr$の臨界点がすべて非退化である
    とき，$f$は\textbf{Morse関数} (Morse function) であるという．
\end{DFN}

\begin{EG}[球面の高さ関数]
    直交座標$(x,y,z)$をもつ3次元空間$\rr^3$のなかの単位球面
    \begin{align}
        S^2=\{(x,y,z)\in\rr^3; x^2+y^2+z^2=1\}
    \end{align}
    を考える．
    「高さ関数」$f\colon S^2\to\rr$を$f(x,y,z)=z$で
    定めると，$f$は$S^2$上のMorse関数である．

    実際，$p_0\in S^2$が$f$の臨界点
    となるのは$z=\pm \sqrt{1-x^2-y^2}$の微分
    \begin{align*}
        f'(p_0)=\left(\frac{\mp x}{\sqrt{1-x^2-y^2}}\quad \frac{\mp y}{\sqrt{1-x^2-y^2}}\right)
    \end{align*}
    が0となるときである．
    よって$p_0$が臨界点となるためには$(x,y)=(0,0)$となることが
    必要十分である．
    よって，$f$の臨界点は$p_0=(0,0,1)$, $q_0=(0,0,-1)$の2点である．
    
    あとはHessianの計算．
    \begin{align*}
        H_f(p_0)=
        \frac{1}{(1-x^2-y^2)^{3/2}}
        \left.\begin{bmatrix*}
            -1+y^2 & -xy\\
            -xy & -1+x^2
        \end{bmatrix*}
        \right|_{(x,y)=(0,0)}
        =\begin{bmatrix*}
            -1&0\\0&-1
        \end{bmatrix*}
    \end{align*}
    なので$\det H_f(p_0)=1\neq 0$である．
    同様に
    \begin{align*}
        H_f(q_0)=
        \frac{1}{(1-x^2-y^2)^{3/2}}
        \left.\begin{bmatrix*}
            1-y^2 & xy\\
            xy & 1-x^2
        \end{bmatrix*}
        \right|_{(x,y)=(0,0)}
        =\begin{bmatrix*}
            1&0\\0&1
        \end{bmatrix*}
    \end{align*}
    なので$\det H_f(q_0)=1\neq 0$である．
    したがって，$f$は$S^2$上のMorse関数である．
\end{EG}

\begin{THM}
    閉曲面$M$の上に，
    非退化な臨界点が2つだけのMorse関数$f\colon M\to \rr$が存在すれば，
    $M$は球面$S^2$に同相である．
\end{THM}

2つの図形$X$と$Y$が\textbf{同相} (homeomorphic) であるとは，
\textbf{同相写像} (homeomorphism)，すなわち
可逆な連続写像$h\colon X\to Y$で
その逆写像$h^{-1}\colon Y\to X$が連続なものが
存在することをいう．

\begin{DFN}
    曲面$M$から曲面$N$への
    同相写像$h\colon M\to N$\textbf{微分同相写像} (diffeomorphism) であるとは，
    $h$と逆写像$h^{-1}$がともに$C^{\infty}$級であることをいう．
\end{DFN}

\begin{THM}[最大値の定理]
    $f\colon X\to \rr$をコンパクト空間$X$の上の連続関数値すると，
    $X$の点$p_0$と$q_0$で$f(p_0)$が最大値となり，$f(q_0)$が最小値
    となるものが存在する．
\end{THM}

\begin{LMM}
    $M_0$上に$C^{\infty}$級関数$f\colon M_0\to\rr$で$M_0$の
    2つの境界$C(p_0)$と$C(q_0)$の上で一定値をとるとする．
    また，$M_0$上に$f$の臨界点はないとする．
    このとき，$M_0$は1つの境界$C(q_0)$と単位閉区間$[0,1]$の
    直積$C(q_0)\times[0,1]$に微分同相である．
\end{LMM}

\begin{LMM}2つの円盤$D_0$と$D_1$の境界の間に微分同相写像
    \begin{align}
        k\colon\p D_0\to\p D_1
    \end{align}
    が与えられると，$k$は円盤の間の微分同相写像
    \begin{align}
        K\colon D_0\to D_1
    \end{align}
    に拡張できる．
\end{LMM}

\begin{LMM}\label{lmm:crit-fin}
    閉曲面$M$上のMorse関数$f\colon M\to\rr$の臨界点は有限個しかない．
\end{LMM}
\subsection{ハンドル分解}

$M$: 閉曲面，$f\colon M\to\rr$: Morse関数とし，$M$: 連結と仮定する．

$M$の「部分曲面」$M_t$を
\begin{align}
    M_t=\{p\in M; f(p)\leqq t\}
\end{align}
で定める．（「劣位集合」とか言ったりするらしい．）$f(p)=t$である点$p$の
集合$L_t$を等高線という．$L_t=\p M_t$である．

$M$: コンパクトなので
\begin{align*}
    A=\max_{p\in M}f(p),\quad a=\min_{p\in M}f(p)
\end{align*}
とおける．$t<a$に対し$M_t=\emp$, $t>A$に対し$M_t=M$である．

\begin{DFN}
    実数$c_0$が$f$の\textbf{臨界値}(critical value) であるとは，
    $c_0$が$f$のある臨界点$p_0$での関数値になっていることをいう．
\end{DFN}

\begin{LMM}
    $b<c$を実数とする．閉区間$[b,c]$に$f$の臨界値が含まれないとする．
    このとき$M_b\cong M_c$（微分同相）である．
\end{LMM}

\begin{proof}[証明]
    $a$, $A$は$f$の臨界点なので，$a<b<c<A$としてよい．
    \begin{align}
        M_{[b,c]}\coloneqq\{p\in M; b\leqq f(p)\leqq c\}
    \end{align}
    とおく．
    \begin{align}
        M_{[b,c]}\cup M_{b}=M_c
    \end{align}
    である．仮定より$M_{[b,c]}$は臨界点をもたない．
    補題\ref{lmm:crit-fin}より$f$の臨界点は有限個なので，
    実数$\e>0$で$M_{[b-\e,c]}$が$f$の臨界点を含まないもの
    が存在する．定理\ref{thm:crit-diff}を用いると，
    \begin{align*}
        M_{[b-\e,c]}\cong f^{-1}(b-\e)\times[0,1]=L_{b-\e}\times[0,1]
    \end{align*}
    が成り立つ．
    $M_{[b-\e,b]}\subset M_{[b-\e,c]}$なので$M_{[b-\e,b]}$にも
    臨界点はない．再び定理\ref{thm:crit-diff}より，
    \begin{align*}
        M_{[b-\e,b]}\cong f^{-1}(b-\e)\times[0,1]=L_{b-\e}\times[0,1]
    \end{align*}
    が成り立つ．
    したがって微分同相$h\colon M_{[b-\e,b]}\overset{\sim}{\longrightarrow} M_{[b-\e,b]}$が存在する．
    $\mapres{h}{L_{b-\e}}\colon L_{b-\e}\to L_{b-\e}$は恒等写像である．
    $\id_{M_{b-\e}}$と$L_{b-\e}$で貼り合わせると
    \begin{align*}
        H=\id\cup h\colon M_{b-\e}\cup M_{[b-\e,b]}
        \overset{\sim}{\longrightarrow}
        \colon M_{b-\e}\cup M_{[b-\e,c]}
    \end{align*}
    が得られる．
\end{proof}

以下，$c_0$を$f$の臨界値とし$p_0$を$f$の
臨界点で$f(p_0)=c_0$となるただ一つのものとする．
このとき，実数$\e>0$で$M_{[c_0-\e,c_0+\e]}$に
属する臨界値が$c_0$のみであるものが存在する．
$p_0$の指数で場合分けする．

\subsubsection{$p_0$の指数が0の場合}
$p_0$のまわりの局所座標$(x,y)$で
\begin{align*}
    f(x,y)=x^2+y^2+c_0
\end{align*}
とかける．
$c_0$が$f$の最小値のとき$M_{c_0-\e}=\emp$であり
\begin{align}
    \begin{aligned}
        M_{c_0+\e}&=\{p\in M; f(p)\leqq c_0+\e\}\\
        &=\{(x,y); x^2+y^2\leqq\e\}    
    \end{aligned}
\end{align}
なので$M_{c_0+\e}\cong D^2$. 

$c_0$が空集合でないときは
\begin{align}
    M_{c_0+\e}\cong M_{c_0-\e}\sqcup D^2.
\end{align}

\subsubsection{$p_0$の指数が1の場合}

$p_0$のまわりの局所座標$(x,y)$で
\begin{align*}
    f(x,y)=-x^2+y^2+c_0
\end{align*}
とかける．
$D^1=[-1,1]$とおく．$\p D^1=\{-1,1\}$である．
\begin{align}
    M_{c_0+\e}\cong M_{c_0-\e}\cup D^1\times D^1.
\end{align}

\subsubsection{$p_0$の指数が2の場合}

$p_0$のまわりの局所座標$(x,y)$で
\begin{align*}
    f(x,y)=-x^2-y^2+c_0
\end{align*}
とかける．
\begin{align}
    \begin{aligned}
        M_{c_0-\e}&=
        \{p\in M; f(p)\leqq c-\e\}\\
        &=\{(x,y); -x^2-y^2\leqq -\e\}\\
        &=\{(x,y); x^2+y^2\geqq \e\}
    \end{aligned}
\end{align}
である．
\begin{align}
    M_{c_0+\e}\cong M_{c_0-\e}\cup D^2.
\end{align}

\subsubsection{ハンドル分解}

\begin{THM}
    Morse関数$f\colon M\to\rr$が存在するとき，
    閉曲面$M$は有限個の0,1,2ハンドルの和として表される．
\end{THM}
\section{一般次元への拡張}

\begin{THM}\label{thm:crit-diff}
    $[a,b]$に$f$の臨界値がなければ$M_{[a,b]}\cong f^{-1}(a)\times[0,1]$
\end{THM}

%\section{ハンドル体}

%\section{多様体のホモロジー}

%\section{低次元多様体}

%\providecommand{\bysame}{\leavevmode\hbox to3em{\hrulefill}\thinspace}
\begin{thebibliography}{15}

\bibitem[M01]{M01} 松本幸夫, Morse理論の基礎, 岩波講座 現代数学の基礎 {\bf 27}, 岩波書店 (2001). 

\bibitem[Ike21]{Ike21} 池祐一, 超局所層理論入門, \url{https://sites.google.com/view/microlocaldustbox/}. 

\bibitem[Ono06]{Ono06} 小野薫, シンプレクティック幾何学におけるFloer理論, 数学 \textbf{58} (2006), pp.113--132.

\end{thebibliography}

\end{document}


